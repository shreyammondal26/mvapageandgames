<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Macro Vision Academy</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700;800;900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        /* Global Reset and Background */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        
        body { 
            background: 
                radial-gradient(ellipse at top, #667eea20 0%, transparent 50%),
                radial-gradient(ellipse at bottom left, #ff6b6b30 0%, transparent 50%),
                radial-gradient(ellipse at bottom right, #4ecdc420 0%, transparent 50%),
                linear-gradient(45deg, #1e3c72, #2a5298, #0f3460, #667eea, #764ba2, #f093fb, #f5576c);
            background-size: 400% 400%;
            animation: cosmicShift 25s ease infinite;
            min-height: 100vh; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            padding: 10px;
            position: relative;
            overflow: hidden;
        }
        
        @keyframes cosmicShift {
            0%, 100% { background-position: 0% 50%, 50% 0%, 100% 100%; }
            33% { background-position: 100% 0%, 0% 100%, 50% 50%; }
            66% { background-position: 50% 100%, 100% 50%, 0% 0%; }
        }

        /* Particle and Neon Glow effects */
        .magic-particles {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0;
        }
        .particle {
            position: absolute; width: 4px; height: 4px; background: rgba(255,255,255,0.9);
            border-radius: 50%; box-shadow: 0 0 12px rgba(255,255,255,0.8);
            animation: particleFloat 8s infinite linear;
        }
        .particle:nth-child(1) { top: 20%; left: 10%; animation-delay: 0s; }
        .particle:nth-child(2) { top: 10%; left: 85%; animation-delay: 2s; width: 3px; height: 3px; }
        .particle:nth-child(3) { top: 70%; left: 15%; animation-delay: 4s; }
        .particle:nth-child(4) { top: 85%; right: 20%; animation-delay: 1s; width: 5px; height: 5px; }
        .particle:nth-child(5) { top: 45%; right: 10%; animation-delay: 3s; }
        .particle:nth-child(6) { top: 60%; left: 70%; animation-delay: 5s; width: 2px; height: 2px; }
        @keyframes particleFloat {
            0% { transform: translateY(0px) rotate(0deg); opacity: 0.6; }
            50% { transform: translateY(-30px) rotate(180deg); opacity: 1; }
            100% { transform: translateY(0px) rotate(360deg); opacity: 0.6; }
        }

        .neon-glow {
            position: fixed; width: 600px; height: 600px; border-radius: 50%;
            background: conic-gradient(#ff00ff, #00ffff, #ffff00, #ff0000, #00ff00, #ff00ff);
            filter: blur(25px); opacity: 0.6; animation: neonRotate 12s linear infinite;
            top: -150px; right: -100px; z-index: 0;
        }
        @keyframes neonRotate { to { transform: rotate(360deg); } }

        /* Container (The Main Box) */
        .container { 
            background: rgba(15, 30, 60, 0.85); 
            backdrop-filter: blur(35px); 
            border: 2px solid rgba(255,255,255,0.25);
            border-radius: 40px; 
            box-shadow: 
                0 40px 100px rgba(0,0,0,0.4),
                0 0 60px rgba(255,255,255,0.1),
                inset 0 1px 0 rgba(255,255,255,0.2);
            width: 95%; max-width: 1250px; max-height: 95vh; overflow: hidden;
            position: relative; z-index: 10;
        }
        
        .screen { display: none; padding: 30px; overflow-y: auto; }
        .screen.active { display: block; }

        .academy-badge {
            position: absolute; top: 15px; left: 15px; z-index: 20;
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            padding: 8px 16px; border-radius: 50px;
            color: white; font-weight: 700; font-size: 11px;
            letter-spacing: 2px; text-transform: uppercase;
            box-shadow: 0 10px 30px rgba(255,107,107,0.4);
            animation: badgePulse 2s ease-in-out infinite alternate;
        }
        @keyframes badgePulse {
            from { box-shadow: 0 10px 30px rgba(255,107,107,0.4); transform: scale(1); }
            to { box-shadow: 0 15px 40px rgba(255,107,107,0.6); transform: scale(1.05); }
        }

        h1 { 
            text-align: center; 
            margin-bottom: 10px; 
            font-size: 2.8em; line-height: 1.1;
            font-family: 'Orbitron', monospace;
            background: linear-gradient(135deg, #ffffff, #ffd700, #ffed4f, #ffffff);
            background-size: 300% 300%;
            -webkit-background-clip: text; background-clip: text;
            color: transparent;
            text-shadow: 
                0 0 20px rgba(255,255,255,0.8),
                0 0 40px rgba(255,215,0,0.6);
            animation: titleGlow 3s ease-in-out infinite alternate;
            position: relative;
        }
        h1::after {
            content: '‚ú®'; position: absolute; top: -15px; left: 50%;
            transform: translateX(-50%); font-size: 20px;
            animation: sparkle 2s ease-in-out infinite;
        }
        @keyframes titleGlow {
            from { filter: brightness(1) drop-shadow(0 0 20px rgba(255,255,255,0.8)); }
            to { filter: brightness(1.2) drop-shadow(0 0 40px rgba(255,215,0,0.9)); }
        }
        @keyframes sparkle {
            0%, 100% { opacity: 0.4; transform: translateX(-50%) scale(1); }
            50% { opacity: 1; transform: translateX(-50%) scale(1.3); }
        }

        .sub-heading {
            text-align: center; color: rgba(255,255,255,0.95);
            margin-bottom: 20px; font-weight: 300; font-size: 14px;
            letter-spacing: 1px;
        }
        
        /* Form/Input Styling */
        .form-group { margin-bottom: 20px; position: relative; }
        label { 
            display: block; margin-bottom: 8px; font-weight: 600; 
            color: #ffd700; font-size: 14px; letter-spacing: 0.5px;
        }
        input, select { 
            width: 100%; padding: 15px 20px; border: 2px solid rgba(255,215,0,0.4); 
            border-radius: 20px; font-size: 14px; background: rgba(255,255,255,0.15);
            backdrop-filter: blur(20px); color: #ffffff; font-weight: 500; 
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        input:focus, select:focus { 
            outline: none; border-color: #ffd700; 
            box-shadow: 0 0 0 5px rgba(255,215,0,0.3), 0 10px 25px rgba(255,215,0,0.2);
            transform: translateY(-2px) scale(1.02); background: rgba(255,255,255,0.25);
        }
        input::placeholder { color: rgba(255,255,255,0.7); }
        
        /* Button Styling */
        .btn, .dash-btn, .back-btn, .chat-send-btn, .subject-btn, .quiz-btn { 
            background: linear-gradient(135deg, #ffd700, #ffed4f, #ffeaa7);
            color: #1e3c72 !important; border: none; border-radius: 20px; 
            font-size: 16px; font-weight: 800; cursor: pointer; 
            position: relative; overflow: hidden; 
            text-transform: uppercase; letter-spacing: 1.2px; transition: all 0.5s ease;
            box-shadow: 0 15px 35px rgba(255,215,0,0.5);
            font-family: 'Orbitron', monospace;
            pointer-events: auto;
        }
        
        .btn { padding: 15px; width: 100%; margin-top: 20px; font-size: 16px; }
        .dash-btn { padding: 20px; height: 120px; font-size: 16px; width: 100%; }
        .dash-btn small { display: block; font-size: 11px; font-weight: 400; opacity: 0.9; margin-top: 6px; text-transform: none; font-family: 'Poppins', sans-serif; }
        .back-btn { padding: 12px 25px; font-size: 14px; display: inline-flex; align-items: center; gap: 6px; margin-bottom: 15px; }
        
        /* Overriding button styles for a different look */
        .subject-btn, .quiz-btn { 
            padding: 20px; font-size: 16px; font-weight: 700; 
            border: 2px solid rgba(255,255,255,0.4); 
            background: rgba(255,255,255,0.15); 
            color: #ffffff !important;
            box-shadow: 0 8px 20px rgba(0,0,0,0.5);
            font-family: 'Poppins', sans-serif;
        }
        .subject-btn:hover, .quiz-btn:hover { 
            background: linear-gradient(135deg, #00d2d3, #a8edea); 
            color: #1e3c72 !important;
            box-shadow: 0 20px 40px rgba(0,210,210,0.7);
        }
        
        .btn:hover, .dash-btn:hover, .back-btn:hover, .chat-send-btn:hover { 
            transform: translateY(-4px) scale(1.03); 
            box-shadow: 0 20px 40px rgba(255,215,0,0.7);
        }
        
        /* Dashboard/Grid Layout */
        .dashboard-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: 20px; margin-top: 20px; 
        }
        .subject-grid { 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); 
            gap: 15px; margin-top: 20px; 
        }
        
        .back-btn { 
            background: linear-gradient(135deg, #636e72, #2d3436); color: white !important;
        }
        .back-btn:hover { transform: translateX(-8px) scale(1.03); box-shadow: 0 15px 30px rgba(99,110,114,0.8); }
        
        /* Logout Button */
        .logout-btn {
            background: linear-gradient(135deg, #b60917a9, #ff3838, #ea0909) !important;
            color: #ffffff !important;
            border: none;
            border-radius: 20px;
            padding: 8px 20px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 20;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(255, 71, 87, 0.4);
            font-family: 'Orbitron', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .logout-btn:hover {
            background: linear-gradient(135deg, #ff3838, #ff4757, #ee5a24) !important;
            transform: translateY(-2px) scale(1.03);
            box-shadow: 0 12px 25px rgba(255, 71, 87, 0.6);
        }
        
        /* Listbox (Papers) Styling */
        .listbox { 
            width: 100%; height: 300px; border: 2px solid rgba(255,215,0,0.5); 
            border-radius: 20px; padding: 20px; background: rgba(255,255,255,0.12); 
            backdrop-filter: blur(25px); overflow-y: auto; margin-bottom: 20px; 
            font-size: 14px; box-shadow: inset 0 5px 20px rgba(0,0,0,0.2);
        }
        .listbox div { 
            padding: 15px 18px; border-bottom: 2px solid rgba(255,255,255,0.15); 
            cursor: pointer; border-radius: 15px; margin-bottom: 10px; transition: all 0.4s; 
            background: rgba(255,255,255,0.1); color: #ffffff; display: flex; 
            justify-content: space-between; align-items: center;
        }
        .listbox div.selected { 
            background: linear-gradient(135deg, #ffd700, #ffed4f); color: #1e3c72; 
            transform: scale(1.02); box-shadow: 0 15px 30px rgba(255,215,0,0.4);
            font-weight: 700;
        }
        
        .student-info { 
            background: linear-gradient(135deg, #00d2d3, #a8edea); color: #0f3460;
            padding: 20px; border-radius: 20px; text-align: center; font-weight: 700; 
            font-size: 16px; margin-bottom: 25px; box-shadow: 0 15px 30px rgba(0,210,210,0.4);
            font-family: 'Orbitron', monospace;
        }
        .student-info strong { font-size: 18px; color: #1e3c72; }

        .pdf-viewer { width: 100%; height: 400px; border: 2px solid rgba(255,215,0,0.5); border-radius: 20px; margin-top: 15px; }
        
        /* Quiz Styling */
        #quizHeader { 
            font-size: 18px; color: #a8edea; font-weight: 700; text-align: center; 
            margin-bottom: 20px; font-family: 'Orbitron', monospace; 
            padding: 12px; background: rgba(255,255,255,0.1); border-radius: 12px;
        }
        .quiz-question { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin-bottom: 15px; border-left: 4px solid #ffd700; }
        .quiz-options { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 15px; }
        .quiz-option { padding: 12px; background: rgba(255,255,255,0.15); border-radius: 12px; cursor: pointer; transition: all 0.3s; border: 2px solid transparent; color: #fff;}
        .quiz-option:hover { background: rgba(255,215,0,0.2); border-color: #ffd700; transform: translateY(-2px); }
        .quiz-option.selected { background: linear-gradient(135deg, #ffd700, #ffed4f); color: #1e3c72; font-weight: 600;}
        .quiz-question strong { display: block; margin-bottom: 8px; font-size: 1.05em; color: #ffd700; }

        /* Game Styling */
        .game-area {
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 20px;
            margin-top: 15px;
            text-align: center;
            min-height: 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .game-score {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, #ffd700, #ffed4f);
            color: #1e3c72;
            padding: 8px 15px;
            border-radius: 15px;
            font-weight: 700;
            font-size: 14px;
        }

        /* Video Player Styles */
        .video-container {
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 20px;
            margin-top: 15px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }
        .video-player {
            width: 100%;
            height: 350px;
            background: #000;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 8px 20px rgba(0,0,0,0.5);
        }
        .video-player video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 15px;
        }
        .video-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        .video-btn {
            background: linear-gradient(135deg, #00d2d3, #a8edea);
            color: #1e3c72;
            border: none;
            border-radius: 20px;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 20px rgba(0,210,210,0.4);
        }
        .video-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 25px rgba(0,210,210,0.6);
        }
        .video-info {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
            margin-top: 15px;
            border-left: 3px solid #ffd700;
        }
        .video-info h3 {
            color: #ffd700;
            margin-bottom: 8px;
            font-size: 1.2em;
        }
        .video-info p {
            color: rgba(255,255,255,0.9);
            line-height: 1.5;
        }

        /* Polymath Engine Chatbot Styles */
        .polymath-chat-container {
            width: 100%;
            height: 80vh;
            background-color: rgba(15, 30, 60, 0.9);
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid rgba(255, 215, 0, 0.3);
            backdrop-filter: blur(5px);
            transition: box-shadow 0.4s ease;
        }
        .polymath-chat-container:hover {
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.4), 0 8px 25px rgba(0, 0, 0, 0.95);
        }

        .polymath-chat-header {
            background-color: rgba(15, 30, 60, 0.8);
            padding: 15px;
            text-align: center;
            border-bottom: 2px solid rgb(255, 217, 0);
            color: #fe0101;
            transition: background-color 0.3s;
        }

        .polymath-chat-header h1 {
            font-size: 1.5em;
            font-weight: 700;
            letter-spacing: 3px;
            text-shadow: 0 0 6px #ff0000, 0 0 12px rgba(0, 210, 211, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .polymath-status {
            width: 10px;
            height: 10px;
            background-color: #00ff08;
            border-radius: 50%;
            margin-left: 8px;
            animation: pulse 2s infinite, glow-status 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(76, 175, 80, 0); }
            100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); }
        }
        @keyframes glow-status {
            0% { box-shadow: 0 0 0 rgba(76, 175, 80, 0.7); }
            50% { box-shadow: 0 0 12px rgba(76, 175, 80, 0.7); }
            100% { box-shadow: 0 0 0 rgba(76, 175, 80, 0); }
        }

        .polymath-chat-window {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            box-shadow: inset 0 0 8px rgb(255, 8, 0);
        }

        .polymath-chat-window::-webkit-scrollbar { width: 8px; } 
        .polymath-chat-window::-webkit-scrollbar-track { background: rgba(15, 30, 60, 0.9); }
        .polymath-chat-window::-webkit-scrollbar-thumb { 
            background-color: #ff0000;
            border-radius: 15px; 
            border: 2px solid rgba(15, 30, 60, 0.9); 
            transition: background-color 0.3s;
        }
        .polymath-chat-window::-webkit-scrollbar-thumb:hover { background-color: #00a8a9; }

        .polymath-message {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .polymath-message.user { flex-direction: row-reverse; }

        .polymath-message-content {
            max-width: 70%;
            padding: 12px 18px;
            border-radius: 20px;
            line-height: 1.5;
            word-wrap: break-word;
            font-size: 1em;
            white-space: pre-wrap;
            box-shadow: 0 5px 12px rgba(0, 0, 0, 0.4);
            transition: transform 0.2s;
        }

        .polymath-message-content:hover {
            transform: translateY(-2px);
        }

        .polymath-message.user .polymath-message-content {
            background-color: #ff0000;
            border-bottom-right-radius: 6px;
            border-left: 3px solid #00d2d3;
        }

        .polymath-message.bot .polymath-message-content {
            background-color: #ff0000;
            border-bottom-left-radius: 6px;
            border-right: 3px solid #00d2d3;
        }

        .polymath-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            flex-shrink: 0;
            font-size: 1.2em;
            border: 2px solid;
        }

        .polymath-message.user .polymath-avatar { 
            background-color: #00d2d3;
            color: rgb(255, 0, 0);
            border-color: #00d2d3;
            box-shadow: 0 0 8px rgb(255, 2, 2);
        }
        .polymath-message.bot .polymath-avatar {
            background-color: #00d2d3;
            color: rgb(255, 0, 0);
            border-color: #00d2d3;
            box-shadow: 0 0 12px 3px #00d2d3;
        }

        .polymath-typing-indicator {
            display: none;
            align-items: center;
            gap: 8px;
        }
        .polymath-typing-indicator .polymath-message-content {
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .polymath-typing-indicator span {
            height: 8px; width: 8px; background-color: #00d2d3;
            border-radius: 50%; display: inline-block;
            box-shadow: 0 0 4px #00d2d3;
            animation: typing 1.4s infinite ease-in-out;
        }
        .polymath-typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .polymath-typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        .polymath-chat-input-form {
            display: flex;
            padding: 15px;
            border-top: 2px solid rgba(0, 210, 211, 0.3);
            background-color: rgba(15, 30, 60, 0.8);
        }
        .polymath-chat-input {
            flex-grow: 1;
            padding: 12px 20px;
            border: 1px solid rgba(0, 210, 211, 0.3);
            border-radius: 25px;
            background-color: rgba(15, 30, 60, 0.9);
            color: #ffffff;
            font-size: 0.9em;
            outline: none;
            box-shadow: inset 0 0 8px rgba(0, 210, 211, 0.15);
            transition: all 0.4s ease;
        }
        .polymath-chat-input:focus {
            border-color: #00d2d3;
            box-shadow: 0 0 15px rgba(0, 210, 211, 0.7);
            background-color: rgba(15, 30, 60, 0.95);
        }
        .polymath-chat-input::placeholder { color: #a0a0a0; }

        .polymath-submit-btn {
            background-image: linear-gradient(45deg, #00a8a9, #00d2d3);
            color: #ffffff;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            margin-left: 12px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5em;
            border: 2px solid #00d2d3;
            box-shadow: 0 0 12px #00d2d3;
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s;
        }
        .polymath-submit-btn:hover {
            background-image: linear-gradient(45deg, #00d2d3, #00a8a9);
            transform: scale(1.05);
            box-shadow: 0 0 15px #00d2d3;
        }

        /* Student Learning Portal Styles */
        .student-portal-container {
            max-width: 400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 8px 20px -5px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .student-portal-container h2 { 
            text-align: center; 
            margin-bottom: 1.2rem; 
            color: #ffd700; 
            font-family: 'Orbitron', monospace;
        }

        .student-portal-container .form-group { 
            margin-bottom: 1rem; 
        }

        .student-portal-container label { 
            display: block; 
            margin-bottom: 5px; 
            font-weight: 600; 
            font-size: 0.9rem; 
            color: #ffd700;
        }

        .student-portal-container input, 
        .student-portal-container select {
            width: 100%;
            padding: 10px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 0.9rem;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .student-portal-container button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #ffd700, #ffed4f);
            color: #1e3c72;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 8px;
            font-family: 'Orbitron', monospace;
        }

        .student-portal-container button:hover { 
            background: linear-gradient(135deg, #ffed4f, #ffd700);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(255, 215, 0, 0.3);
        }

        #worksheetSection { display: none; }

        .welcome-header {
            text-align: center;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 12px;
            margin-bottom: 15px;
        }

        .resource-item {
            background: rgba(255, 255, 255, 0.1);
            margin: 10px 0;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            transition: transform 0.2s;
        }

        .resource-item:hover { 
            transform: translateY(-2px); 
            border-color: #ffd700; 
            box-shadow: 0 3px 5px -1px rgba(255, 215, 0, 0.2); 
        }

        .resource-item a { 
            text-decoration: none; 
            color: #fff; 
            font-weight: 600; 
            flex-grow: 1; 
        }

        .subject-icon { 
            margin-right: 12px; 
            font-size: 1.3rem; 
        }

        .badge {
            display: inline-block;
            padding: 3px 10px;
            background: rgba(255, 215, 0, 0.2);
            color: #ffd700;
            border-radius: 15px;
            font-size: 0.8rem;
            margin-top: 3px;
        }

        /* PW Little Champs Video Selector Styles */
        .pw-container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
        }

        .pw-header {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .pw-header h1 {
            font-size: 2em;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #f9ca24);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 12px;
            font-weight: 800;
        }

        .pw-header p {
            font-size: 1.1em;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
        }

        .class-tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .class-tab {
            padding: 10px 20px;
            border: 2px solid transparent;
            border-radius: 30px;
            font-size: 1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
            color: #fff;
        }

        .class-tab.active {
            border-color: #ffd700;
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(255, 215, 0, 0.3);
        }

        .class-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }

        .class-content {
            display: none;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .class-content.active {
            display: block;
            animation: fadeInUp 0.6s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .class-badge {
            background: linear-gradient(45deg, #ff9a9e, #fecfef);
            color: #c44569;
            padding: 8px 20px;
            border-radius: 20px;
            display: inline-block;
            font-size: 1.1em;
            font-weight: 700;
            margin-bottom: 15px;
            box-shadow: 0 6px 15px rgba(255, 154, 158, 0.3);
        }

        .class6-badge { background: linear-gradient(45deg, #ff9a9e, #fecfef); color: #c44569; }
        .class7-badge { background: linear-gradient(45deg, #a8edea, #fed6e3); color: #d63384; }
        .class8-badge { background: linear-gradient(45deg, #1e3c72, #2a5298); color: #3498db; }

        .selector-group {
            margin-bottom: 20px;
        }

        .selector-group label {
            display: block;
            margin-bottom: 10px;
            color: #ffd700;
            font-weight: 700;
            font-size: 1em;
        }

        .selector-group select {
            width: 100%;
            padding: 12px;
            border: 3px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            font-size: 1em;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            cursor: pointer;
            font-weight: 600;
            color: #fff;
        }

        .selector-group select:focus {
            outline: none;
            border-color: #ffd700;
            box-shadow: 0 0 0 4px rgba(255, 215, 0, 0.15);
            transform: translateY(-2px);
        }

        .video-container {
            margin-top: 25px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 3px solid rgba(255, 215, 0, 0.3);
            display: none;
            box-shadow: 0 15px 30px rgba(255, 215, 0, 0.15);
        }

        .video-container.show {
            display: block;
            animation: slideUp 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .video-container iframe {
            width: 100%;
            height: 300px;
            border-radius: 15px;
            border: none;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }

        .video-title {
            margin-top: 15px;
            color: #fff;
            font-size: 1.2em;
            font-weight: 700;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            line-height: 1.3;
        }

        /* Chill Games Styles - COMPACT VERSION */
        .chill-games-container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
        }

        .chill-games-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .chill-games-header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.5);
            color: #ffd700;
        }

        .chill-games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
        }

        .chill-game-card {
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.3);
            position: relative;
            overflow: hidden;
        }

        .chill-game-card:hover {
            transform: translateY(-5px) scale(1.03);
            background: rgba(255,255,255,0.3);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .chill-game-icon {
            font-size: 2.5em;
            margin-bottom: 8px;
        }

        .chill-game-title {
            font-size: 1em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #fff;
        }

        .chill-game-area {
            display: none;
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px;
            margin-top: 15px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.3);
            text-align: center;
            animation: fadeIn 0.5s ease;
            max-height: 70vh;
            overflow-y: auto;
        }

        .chill-back-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .chill-game-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            margin: 8px 5px;
            font-size: 14px;
        }

        .chill-game-canvas {
            border: 3px solid rgba(255,255,255,0.6);
            border-radius: 10px;
            display: block;
            margin: 15px auto;
            background: #000;
        }

        /* XO Grid Specifics - COMPACT */
        .chill-xo-grid {
            display: grid;
            grid-template-columns: repeat(3, 90px);
            gap: 10px;
            margin: 20px auto;
            width: 290px;
            position: relative;
        }

        .chill-xo-cell {
            width: 90px;
            height: 90px;
            background: rgba(255,255,255,0.95);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            color: #333;
            cursor: pointer;
        }

        /* Memory Game Styles - COMPACT */
        .chill-memory-grid {
            display: grid;
            gap: 10px;
            margin: 20px auto;
        }

        .chill-easy .chill-memory-grid {
            grid-template-columns: repeat(4, 70px);
            width: 300px;
        }

        .chill-memory-card {
            width: 100%;
            height: 70px;
            position: relative;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: all 0.5s;
        }

        .chill-memory-card.flipped {
            transform: rotateY(180deg);
        }

        .chill-card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
        }

        .chill-card-back {
            background: #e74c3c;
        }

        .chill-card-front {
            background: #27ae60;
            transform: rotateY(180deg);
        }

        .chill-sound-toggle {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.2em;
            cursor: pointer;
            z-index: 100;
        }

        .chill-pause-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            border-radius: 10px;
        }

        .chill-pause-overlay.active {
            display: flex;
        }

        /* Game Instructions - COMPACT */
        .game-instructions {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 10px;
            margin-top: 10px;
            font-size: 0.9em;
            color: rgba(255,255,255,0.9);
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .screen { padding: 20px 15px; }
            h1 { font-size: 2.2em; }
            .dashboard-grid, .subject-grid, .quiz-options { grid-template-columns: 1fr; }
            .academy-badge { position: static; margin-bottom: 15px; text-align: center; }
            .polymath-chat-container {
                width: 100%;
                height: 100%;
                border-radius: 0;
            }
            .polymath-chat-header h1 {
                font-size: 1.3em;
                letter-spacing: 1.5px;
            }
            .polymath-message-content {
                max-width: 85%;
            }
            .video-player {
                height: 200px;
            }
            .pw-header h1 { font-size: 1.6em; }
            .class-tabs { flex-direction: column; align-items: center; }
            .class-tab { width: 200px; }
            .video-container iframe { height: 200px; }
            .class-content { padding: 15px 12px; }
            .chill-games-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            }
            .chill-xo-grid {
                grid-template-columns: repeat(3, 70px);
                width: 220px;
            }
            .chill-xo-cell {
                width: 70px;
                height: 70px;
                font-size: 2em;
            }
            .chill-easy .chill-memory-grid {
                grid-template-columns: repeat(4, 60px);
                width: 260px;
            }
            .chill-memory-card {
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="neon-glow"></div>
    <div class="magic-particles">
        <div class="particle"></div><div class="particle"></div><div class="particle"></div>
        <div class="particle"></div><div class="particle"></div><div class="particle"></div>
    </div>
    
    <div class="container">
        <div class="academy-badge">MACRO VISION ACADEMY</div>
        
        <div id="loginScreen" class="screen active">
            <h1>Macro Vision Academy</h1>
            <p class="sub-heading">Advanced learning portal with smart papers & AI guidance ‚ú®</p>

            <div class="form-group">
                <label>üë§ Student Name</label>
                <input type="text" id="nameInput" placeholder="Enter your full name">
            </div>
            <div class="form-group">
                <label>üìö Grade</label>
                <select id="classInput">
                    <option value="">Select Grade</option>
                    <option value="6">Grade 6</option>
                    <option value="7">Grade 7</option>
                    <option value="8">Grade 8</option>
                </select>
            </div>
            <div class="form-group">
                <label>üè∑Ô∏è Section</label>
                <select id="sectionInput">
                    <option value="">Select Section</option>
                    <option value="A">A</option>
                    <option value="B">B</option>
                    <option value="C">C</option>
                    <option value="D">D</option>
                </select>
            </div>
            <div class="form-group">
                <label>üî¢ Student ID</label>
                <input type="text" id="rollInput" placeholder="Enter student ID">
            </div>
            <button class="btn" onclick="login()">üöÄ Launch Learning Portal</button>
        </div>

        <div id="dashboardScreen" class="screen">
            <button class="logout-btn" onclick="logout()">üö™ Logout</button>
            <div class="student-info" id="studentInfo"></div>
            <h1>Learning Dashboard</h1>
            <p class="sub-heading">Master your studies with Macro Vision Academy's premium tools ‚ú®</p>
            <div class="dashboard-grid">
                <button class="dash-btn" onclick="showSamplePapers()">
                    üìö Smart Practice Papers
                    <small>AI-generated exam-level questions</small>
                </button>
                <button class="dash-btn" onclick="showVideos()">
                    üé¨ Concept Videos
                    <small>Interactive video lessons & tutorials</small>
                </button>
                <button class="dash-btn" onclick="showQuiz()">
                    ‚ùì Quiz Mode
                    <small>Timed MCQ quizzes for fast practice</small>
                </button>
                <button class="dash-btn" onclick="showGames()">
                    üéÆ Chill Games
                    <small>Fun games to relax and refresh your mind</small>
                </button>
                <button class="dash-btn" onclick="showPolymath()">
                    ‚öõ Polymath Engine
                    <small>Advanced AI-powered knowledge assistant</small>
                </button>
            </div>
        </div>

        <div id="papersScreen" class="screen">
            <button class="back-btn" onclick="showDashboard()">‚¨Ö Back to Dashboard</button>
            
            <!-- Student Learning Portal -->
            <div class="student-portal-container">
                <div id="loginForm">
                    <h2>Student Login</h2>
                    <div class="form-group">
                        <label>First Name</label>
                        <input type="text" id="firstName" placeholder="Enter your name">
                    </div>
                    <div class="form-group">
                        <label>Section</label>
                        <input type="text" id="section" placeholder="e.g. A or B">
                    </div>
                    <div class="form-group">
                        <label>Student ID</label>
                        <input type="text" id="studentID" placeholder="Enter ID number">
                    </div>
                    <div class="form-group">
                        <label>Select Class</label>
                        <select id="classSelect">
                            <option value="">-- Choose Class --</option>
                            <option value="6">Class 6</option>
                            <option value="7">Class 7</option>
                            <option value="8">Class 8</option>
                        </select>
                    </div>
                    <button onclick="handlePaperLogin()">Access Worksheets</button>
                </div>

                <div id="worksheetSection">
                    <div class="welcome-header">
                        <h3>Hi, <span id="displayUserName" style="color:#ffd700"></span>!</h3>
                        <div class="badge" id="displayInfo"></div>
                    </div>
                    
                    <div id="linksContainer"></div>

                    <button style="background-color: #64748b; margin-top: 15px;" onclick="resetPaperLogin()">Logout</button>
                </div>
            </div>
        </div>

        <div id="videosScreen" class="screen">
            <button class="back-btn" onclick="showDashboard()">‚¨Ö Back to Dashboard</button>
            
            <!-- PW Little Champs Video Selector -->
            <div class="pw-container">
                <div class="pw-header">
                    <h1>üöÄ PW Little Champs</h1>
                    <p>Complete Marathon Videos - Classes 6th, 7th & 8th</p>
                </div>

                <div class="class-tabs">
                    <div class="class-tab active" data-class="6">üèÜ Class 6th</div>
                    <div class="class-tab" data-class="7">‚≠ê Class 7th</div>
                    <div class="class-tab" data-class="8">‚ö° Class 8th</div>
                </div>

                <!-- Class 6th -->
                <div class="class-content active" id="class6">
                    <div class="class-badge class6-badge">Class 6th - Champs Batch</div>
                    <div class="selector-group">
                        <label for="subject6">Select Subject:</label>
                        <select id="subject6">
                            <option value="">Choose Subject...</option>
                            <option value="Science">üî¨ Science</option>
                            <option value="SST">üåç Social Science</option>
                            <option value="Maths">üìê Maths</option>
                            <option value="Hindi">üìö Hindi</option>
                        </select>
                    </div>
                    <div class="video-container" id="video6">
                        <iframe id="videoFrame6" allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" referrerpolicy="no-referrer-when-downgrade"></iframe>
                        <div class="video-title" id="videoTitle6"></div>
                    </div>
                </div>

                <!-- Class 7th - 5 VIDEOS -->
                <div class="class-content" id="class7">
                    <div class="class-badge class7-badge">Class 7th - Junoon Batch (5 Videos)</div>
                    <div class="selector-group">
                        <label for="subject7">Select Subject:</label>
                        <select id="subject7">
                            <option value="">Choose Subject...</option>
                            <option value="Hindi">üìñ Hindi</option>
                            <option value="Social">üåç Social Science</option>
                            <option value="Maths">üìê Maths (Mid Term)</option>
                            <option value="Science">üî¨ Science (Complete)</option>
                            <option value="English">üìö English (Complete)</option>
                        </select>
                    </div>
                    <div class="video-container" id="video7">
                        <iframe id="videoFrame7" allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" referrerpolicy="no-referrer-when-downgrade"></iframe>
                        <div class="video-title" id="videoTitle7"></div>
                    </div>
                </div>

                <!-- Class 8th -->
                <div class="class-content" id="class8">
                    <div class="class-badge class8-badge">Class 8th - Umang/Riser Batch</div>
                    <div class="selector-group">
                        <label for="subject8">Select Subject:</label>
                        <select id="subject8">
                            <option value="">Choose Subject...</option>
                            <option value="Hindi">üìñ Hindi</option>
                            <option value="Science">üî¨ Science</option>
                            <option value="SST">üåç Social Science</option>
                            <option value="Maths">üìê Maths</option>
                        </select>
                    </div>
                    <div class="video-container" id="video8">
                        <iframe id="videoFrame8" allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" referrerpolicy="no-referrer-when-downgrade"></iframe>
                        <div class="video-title" id="videoTitle8"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="polymathScreen" class="screen">
            <div class="polymath-chat-container">
                <div class="polymath-chat-header">
                    <h1>MACRO VISION ACADEMY Polymath Engine ‚öõ <span class="polymath-status"></span></h1>
                </div>
                <div class="polymath-chat-window" id="polymath-chat-window">
                    <div class="polymath-message bot">
                        <div class="polymath-avatar">‚öõ</div> 
                        <div class="polymath-message-content">Welcome to MACRO VISION ACADEMY Polymath Engine. I integrate knowledge from various fields to provide comprehensive answers and can learn from your input. How can I facilitate your learning today?</div>
                    </div>
                </div>
                <form class="polymath-chat-input-form" id="polymath-chat-form">
                    <input type="text" class="polymath-chat-input" id="polymath-chat-input" placeholder="Inquire about Science, History, or Math..." autocomplete="off" required>
                    <button type="submit" class="polymath-submit-btn">‚ñ∂</button>
                </form>
            </div>
            <button class="back-btn" onclick="showDashboard()" style="position: absolute; top: 15px; left: 15px; z-index: 100;">‚¨Ö Back to Dashboard</button>
        </div>

        <div id="quizScreen" class="screen">
            <button class="back-btn" onclick="showDashboard()">‚¨Ö Back to Dashboard</button>
            <h1>Quiz Mode</h1>
            <p class="sub-heading" id="quizSubHeading">Select a subject to start a 15-Question timed quiz ‚ú®</p>
            
            <div id="quizSubjectSelection" class="dashboard-grid">
                <button class="dash-btn" onclick="startSubjectQuiz('Mathematics')">üìê Start Mathematics Quiz</button>
                <button class="dash-btn" onclick="startSubjectQuiz('Science')">üß™ Start Science Quiz</button>
                <button class="dash-btn" onclick="startSubjectQuiz('Social Studies')">üåç Start Social Studies Quiz</button>
                <button class="dash-btn" onclick="startSubjectQuiz('English')">üìñ Start English Quiz</button>
            </div>

            <div id="quizContainer" style="display:none;">
                <div id="quizHeader"></div>
                
                <div id="quizContent">
                    </div>
                
                <div style="display:flex;gap:15px;margin-top:20px;">
                    <button class="btn" onclick="nextQuestion()">‚û°Ô∏è Next Question</button>
                    <button class="btn" onclick="submitQuiz()">‚úÖ Submit & View Score</button>
                </div>
                <div id="quizResult" style="margin-top:15px;color:#ffd700;font-size:18px;font-weight:700;text-align:center;"></div>
            </div>
        </div>

        <div id="gamesScreen" class="screen">
            <button class="back-btn" onclick="showDashboard()">‚¨Ö Back to Dashboard</button>
            
            <!-- Chill Games Container - COMPACT VERSION -->
            <div class="chill-games-container">
                <div class="chill-games-header">
                    <h1>üéÆ Chill Games Zone</h1>
                    <p>XO ‚Ä¢ Snake ‚Ä¢ Tetris ‚Ä¢ Flappy Bird ‚Ä¢ Dino ‚Ä¢ Memory ‚Ä¢ Breakout ‚Ä¢ Shooter ‚Ä¢ Pong</p>
                </div>

                <button class="chill-sound-toggle" id="soundToggle" onclick="toggleSound()">üîä</button>

                <div class="chill-games-grid" id="chillGamesGrid">
                    <div class="chill-game-card" onclick="showChillGame('xo')">
                        <div class="chill-game-icon">‚ùå‚≠ï</div>
                        <div class="chill-game-title">XO</div>
                    </div>
                    <div class="chill-game-card" onclick="showChillGame('snake')">
                        <div class="chill-game-icon">üêç</div>
                        <div class="chill-game-title">Snake</div>
                    </div>
                    <div class="chill-game-card" onclick="showChillGame('tetris')">
                        <div class="chill-game-icon">üß©</div>
                        <div class="chill-game-title">Tetris</div>
                    </div>
                    <div class="chill-game-card" onclick="showChillGame('flappy')">
                        <div class="chill-game-icon">üê¶</div>
                        <div class="chill-game-title">Flappy</div>
                    </div>
                    <div class="chill-game-card" onclick="showChillGame('dino')">
                        <div class="chill-game-icon">ü¶ï</div>
                        <div class="chill-game-title">Dino</div>
                    </div>
                    <div class="chill-game-card" onclick="showChillGame('memory')">
                        <div class="chill-game-icon">üß†‚ú®</div>
                        <div class="chill-game-title">Memory</div>
                    </div>
                    <div class="chill-game-card" onclick="showChillGame('breakout')">
                        <div class="chill-game-icon">üéÆ</div>
                        <div class="chill-game-title">Breakout</div>
                    </div>
                    <div class="chill-game-card" onclick="showChillGame('shooter')">
                        <div class="chill-game-icon">üî´</div>
                        <div class="chill-game-title">Shooter</div>
                    </div>
                    <div class="chill-game-card" onclick="showChillGame('pong')">
                        <div class="chill-game-icon">üèì</div>
                        <div class="chill-game-title">Pong</div>
                    </div>
                </div>

                <div class="chill-pause-overlay" id="chillPauseOverlay">
                    <div>‚è∏Ô∏è PAUSED</div>
                    <button onclick="togglePause()">RESUME</button>
                </div>

                <!-- XO Game - COMPACT -->
                <div id="chillXoGame" class="chill-game-area">
                    <button class="chill-back-btn" onclick="showChillGames()">‚Üê BACK</button>
                    <h2>XO Game</h2>
                    <div class="chill-xo-grid" id="chillXoGrid"></div>
                    <button class="chill-game-btn" onclick="resetXO()">üîÑ NEW GAME</button>
                </div>

                <!-- Snake Game - COMPACT -->
                <div id="chillSnakeGame" class="chill-game-area">
                    <button class="chill-back-btn" onclick="showChillGames()">‚Üê BACK</button>
                    <h2>Snake Game</h2>
                    <canvas id="snake-canvas" class="chill-game-canvas" width="300" height="300"></canvas>
                    <div class="game-score">Score: <span id="snake-score">0</span></div>
                    <div class="game-controls">
                        <button class="chill-game-btn" onclick="startSnake()">Start</button>
                        <button class="chill-game-btn" onclick="pauseSnake()">Pause</button>
                    </div>
                    <div class="game-instructions">
                        Use arrow keys to control the snake. Eat food to grow longer!
                    </div>
                </div>

                <!-- Tetris Game - COMPACT -->
                <div id="chillTetrisGame" class="chill-game-area">
                    <button class="chill-back-btn" onclick="showChillGames()">‚Üê BACK</button>
                    <h2>Tetris</h2>
                    <canvas id="tetris-canvas" class="chill-game-canvas" width="240" height="400"></canvas>
                    <div class="game-score">Score: <span id="tetris-score">0</span></div>
                    <div class="game-controls">
                        <button class="chill-game-btn" onclick="startTetris()">Start</button>
                        <button class="chill-game-btn" onclick="pauseTetris()">Pause</button>
                    </div>
                    <div class="game-instructions">
                        ‚Üê ‚Üí Move, ‚Üì Drop, ‚Üë Rotate. Clear lines to score!
                    </div>
                </div>

                <!-- Flappy Bird Game - COMPACT -->
                <div id="chillFlappyGame" class="chill-game-area">
                    <button class="chill-back-btn" onclick="showChillGames()">‚Üê BACK</button>
                    <h2>Flappy Bird</h2>
                    <canvas id="flappy-canvas" class="chill-game-canvas" width="300" height="400"></canvas>
                    <div class="game-score">Score: <span id="flappy-score">0</span></div>
                    <div class="game-controls">
                        <button class="chill-game-btn" onclick="startFlappy()">Start</button>
                    </div>
                    <div class="game-instructions">
                        Click or press Space to fly. Avoid the pipes!
                    </div>
                </div>

                <!-- Dino Game - COMPACT -->
                <div id="chillDinoGame" class="chill-game-area">
                    <button class="chill-back-btn" onclick="showChillGames()">‚Üê BACK</button>
                    <h2>Dino Run</h2>
                    <canvas id="dino-canvas" class="chill-game-canvas" width="400" height="200"></canvas>
                    <div class="game-score">Score: <span id="dino-score">0</span> | Best: <span id="dino-best-score">0</span></div>
                    <div class="game-controls">
                        <button class="chill-game-btn" onclick="startDino()">Start</button>
                    </div>
                    <div class="game-instructions">
                        Press Space or Click to jump. Avoid obstacles!
                    </div>
                </div>

                <!-- Memory Game - COMPACT -->
                <div id="chillMemoryGame" class="chill-game-area chill-easy">
                    <button class="chill-back-btn" onclick="showChillGames()">‚Üê BACK</button>
                    <h2>Memory Game</h2>
                    <div class="chill-memory-grid" id="chillMemoryGrid"></div>
                    <div>Moves: <span id="chillMemoryMoves">0</span></div>
                    <button class="chill-game-btn" onclick="resetMemory()">üîÑ NEW GAME</button>
                </div>

                <!-- Breakout Game - COMPACT -->
                <div id="chillBreakoutGame" class="chill-game-area">
                    <button class="chill-back-btn" onclick="showChillGames()">‚Üê BACK</button>
                    <h2>Breakout</h2>
                    <canvas id="chillBreakoutCanvas" class="chill-game-canvas" width="400" height="300"></canvas>
                    <div class="game-score">Score: <span id="chillBreakoutScore">0</span></div>
                    <button class="chill-game-btn" onclick="resetBreakout()">üîÑ NEW GAME</button>
                </div>

                <!-- Shooter Game - COMPACT -->
                <div id="chillShooterGame" class="chill-game-area">
                    <button class="chill-back-btn" onclick="showChillGames()">‚Üê BACK</button>
                    <h2>Shooter</h2>
                    <canvas id="chillShooterCanvas" class="chill-game-canvas" width="400" height="300"></canvas>
                    <div class="game-score">Score: <span id="chillShooterScore">0</span></div>
                    <button class="chill-game-btn" onclick="resetShooter()">üîÑ NEW GAME</button>
                </div>

                <!-- Pong Game - COMPACT -->
                <div id="chillPongGame" class="chill-game-area">
                    <button class="chill-back-btn" onclick="showChillGames()">‚Üê BACK</button>
                    <h2>Pong</h2>
                    <canvas id="chillPongCanvas" class="chill-game-canvas" width="400" height="250"></canvas>
                    <div class="game-score">Player: <span id="chillPongPlayerScore">0</span> | Computer: <span id="chillPongCompScore">0</span></div>
                    <button class="chill-game-btn" onclick="resetPong()">üîÑ NEW GAME</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStudent = {};
        let selectedPaper = null;
        let currentQuizAnswer = null;
        let gameScore = 0;
        let gameTimer = null;
        
        // Sample papers (2 per subject per grade)
        const samplePapers = {
            6: [
                'Mathematics Foundation Set A', 'Mathematics Foundation Set B', 
                'Science Basics Paper 1', 'Science Basics Paper 2', 
                'Social Studies Explorer A', 'Social Studies Explorer B', 
                'English Grammar Test 1', 'English Grammar Test 2'
            ],
            7: [
                'Mathematics Progress A', 'Mathematics Progress B', 
                'Science Discovery Paper 1', 'Science Discovery Paper 2', 
                'Social Studies World A', 'Social Studies World B', 
                'English Literature I', 'English Literature II'
            ],
            8: [
                'Mathematics Excellence A', 'Mathematics Excellence B', 
                'Science Investigation P1', 'Science Investigation P2', 
                'Social Studies Civics A', 'Social Studies Civics B', 
                'English Writing Skills I', 'English Writing Skills II'
            ],
            9: [
                'Mathematics Advanced Test 1', 'Mathematics Advanced Test 2', 
                'Science Physics Set A', 'Science Physics Set B', 
                'Social Studies History A', 'Social Studies History B', 
                'English Comprehension I', 'English Comprehension II'
            ],
            10: [
                'Mathematics Board Prep A', 'Mathematics Board Prep B', 
                'Science Chemistry Test 1', 'Science Chemistry Test 2', 
                'Social Studies Geography A', 'Social Studies Geography B', 
                'English Board Level I', 'English Board Level II'
            ],
            11: [
                'Advanced Calculus Exam A', 'Advanced Calculus Exam B', 
                'Physics Mechanics Test 1', 'Physics Mechanics Test 2', 
                'History Modern World A', 'History Modern World B', 
                'English Advanced Set A', 'English Advanced Set B'
            ],
            12: [
                'Mathematics Final Set A', 'Mathematics Final Set B', 
                'Biology Life Sciences P1', 'Biology Life Sciences P2', 
                'Economics Principles A', 'Economics Principles B', 
                'English Proficiency I', 'English Proficiency II'
            ]
        };

        let currentQuiz = {
            subject: '',
            questions: [],
            currentIndex: 0,
            score: 0,
            active: false,
            timer: null
        };
        
        const quizData = {
            Mathematics: [
                { q: "What is 15 √ó 8?", options: ["110", "120", "130", "150"], ans: "120" },
                { q: "Square root of 81?", options: ["7", "8", "9", "10"], ans: "9" },
                { q: "The value of 2¬≥ is?", options: ["4", "6", "8", "16"], ans: "8" },
                { q: "Area of a circle formula?", options: ["2œÄr", "œÄr¬≤", "œÄd", "l√ów"], ans: "œÄr¬≤" },
                { q: "How many sides does a pentagon have?", options: ["4", "5", "6", "7"], ans: "5" },
                { q: "What is 50% of 200?", options: ["50", "100", "150", "200"], ans: "100" },
                { q: "If x+5=12, then x is?", options: ["5", "7", "8", "10"], ans: "7" },
                { q: "Perimeter of a square with side 4?", options: ["4", "8", "16", "20"], ans: "16" },
                { q: "Prime number after 7?", options: ["8", "9", "11", "13"], ans: "11" },
                { q: "Value of (10-5) √ó 2?", options: ["5", "10", "15", "20"], ans: "10" },
                { q: "What is 1/4 as a decimal?", options: ["0.20", "0.25", "0.40", "0.50"], ans: "0.25" },
                { q: "Next number in 2, 4, 8, 16...?", options: ["24", "28", "32", "36"], ans: "32" },
                { q: "Which is a multiple of 3?", options: ["7", "10", "14", "18"], ans: "18" },
                { q: "Convert 1 km to meters.", options: ["100m", "500m", "1000m", "10000m"], ans: "1000m" },
                { q: "What is LCM of 3 and 4?", options: ["7", "12", "15", "24"], ans: "12" },
            ],
            Science: [
                { q: "What gas do plants release?", options: ["CO‚ÇÇ", "Nitrogen", "Oxygen", "Methane"], ans: "Oxygen" },
                { q: "The unit of force is?", options: ["Joule", "Watt", "Newton", "Volt"], ans: "Newton" },
                { q: "Planet closest to sun?", options: ["Venus", "Earth", "Mars", "Mercury"], ans: "Mercury" },
                { q: "What is formula for water?", options: ["H‚ÇÇO‚ÇÇ", "CO‚ÇÇ", "H‚ÇÇO", "NaCl"], ans: "H‚ÇÇO" },
                { q: "Which is a conductor?", options: ["Wood", "Plastic", "Glass", "Copper"], ans: "Copper" },
                { q: "Blood carries this from the lungs.", options: ["CO‚ÇÇ", "Oxygen", "Food", "Waste"], ans: "Oxygen" },
                { q: "Source of energy for Earth?", options: ["Moon", "Stars", "Sun", "Jupiter"], ans: "Sun" },
                { q: "Process where liquid turns to gas.", options: ["Melting", "Condensation", "Evaporation", "Freezing"], ans: "Evaporation" },
                { q: "The basic unit of life.", options: ["Atom", "Molecule", "Tissue", "Cell"], ans: "Cell" },
                { q: "A magnetic metal.", options: ["Gold", "Silver", "Iron", "Aluminium"], ans: "Iron" },
                { q: "How many bones in an adult human?", options: ["200", "206", "210", "300"], ans: "206" },
                { q: "The force that pulls things down.", options: ["Tension", "Friction", "Gravity", "Thrust"], ans: "Gravity" },
                { q: "What is pH of pure water?", options: ["0", "7", "14", "5.5"], ans: "7" },
                { q: "Largest organ in human body.", options: ["Heart", "Lungs", "Brain", "Skin"], ans: "Skin" },
                { q: "What is rust chemically?", options: ["Iron Oxide", "Carbon Dioxide", "Water", "Sulfuric Acid"], ans: "Iron Oxide" },
            ],
            "Social Studies": [
                { q: "Capital of United States?", options: ["New York", "Washington D.C.", "Los Angeles", "Chicago"], ans: "Washington D.C." },
                { q: "Who wrote 'The Star-Spangled Banner'?", options: ["Ben Franklin", "Francis Scott Key", "Thomas Jefferson", "George Washington"], ans: "Francis Scott Key" },
                { q: "What is a democracy?", options: ["Rule by one", "Rule by few", "Rule by people", "Military rule"], ans: "Rule by people" },
                { q: "Largest continent?", options: ["Europe", "Africa", "North America", "Asia"], ans: "Asia" },
                { q: "Which monument is in Washington D.C.?", options: ["Statue of Liberty", "Lincoln Memorial", "Mount Rushmore", "Golden Gate Bridge"], ans: "Lincoln Memorial" },
                { q: "The Earth is also called to ___ planet.", options: ["Red", "Blue", "Green", "White"], ans: "Blue" },
                { q: "Father of the American Constitution?", options: ["Washington", "Jefferson", "Madison", "Hamilton"], ans: "Madison" },
                { q: "Highest mountain in North America?", options: ["Mount McKinley", "Mount Whitney", "Mount Rainier", "Mount Elbert"], ans: "Mount McKinley" },
                { q: "Which ocean is the largest?", options: ["Atlantic", "Indian", "Arctic", "Pacific"], ans: "Pacific" },
                { q: "Who was the first President of United States?", options: ["Jefferson", "Adams", "Washington", "Franklin"], ans: "Washington" },
                { q: "The US Constitution was signed in which year?", options: ["1776", "1787", "1789", "1791"], ans: "1787" },
                { q: "What is the study of weather called?", options: ["Geology", "Meteorology", "Ecology", "Astronomy"], ans: "Meteorology" },
                { q: "The main source of light and heat for the solar system.", options: ["Moon", "Jupiter", "Sun", "Mars"], ans: "Sun" },
                { q: "The US shares a border with which country to the north?", options: ["Mexico", "Canada", "Cuba", "Bahamas"], ans: "Canada" },
                { q: "What is the capital of Canada?", options: ["Toronto", "Montreal", "Vancouver", "Ottawa"], ans: "Ottawa" },
            ],
            English: [
                { q: "Synonym of 'Happy'?", options: ["Sad", "Joyful", "Angry", "Tired"], ans: "Joyful" },
                { q: "Past tense of 'Run'?", options: ["Running", "Ran", "Runned", "Rans"], ans: "Ran" },
                { q: "An adjective describes a __.", options: ["Verb", "Noun", "Adverb", "Preposition"], ans: "Noun" },
                { q: "Plural of 'Mouse'?", options: ["Mouses", "Mice", "Mouse", "Mes"], ans: "Mice" },
                { q: "The opposite of 'Big' is?", options: ["Great", "Large", "Small", "Tall"], ans: "Small" },
                { q: "Which is a preposition?", options: ["Quickly", "Jump", "Under", "She"], ans: "Under" },
                { q: "Correct spelling?", options: ["Neccesary", "Necessary", "Necesaary", "Nesessary"], ans: "Necessary" },
                { q: "Identify the verb: 'The bird sings loudly.'", options: ["The", "Bird", "Sings", "Loudly"], ans: "Sings" },
                { q: "A group of lions is called a __.", options: ["Herd", "Pack", "Pride", "Flock"], ans: "Pride" },
                { q: "What is an Antonym?", options: ["Same meaning", "Opposite meaning", "Rhyming word", "Compound word"], ans: "Opposite meaning" },
                { q: "Fill in the blank: 'He went ___ the store.'", options: ["to", "too", "two", "at"], ans: "to" },
                { q: "A sentence must have a subject and a __.", options: ["Object", "Adjective", "Predicate", "Conjunction"], ans: "Predicate" },
                { q: "What is the noun in 'The green grass is soft.'?", options: ["The", "Green", "Grass", "Soft"], ans: "Grass" },
                { q: "Synonym for 'Quiet'.", options: ["Loud", "Silent", "Active", "Fast"], ans: "Silent" },
                { q: "Which punctuation mark ends a statement?", options: ["?", "!", ".", ","], ans: "."},
            ]
        };

        // --- VIDEO DATA ---
        const videoData = {
            maths: [
                {
                    title: "Introduction to Algebra",
                    description: "Learn the basics of algebraic expressions and equations in this comprehensive introduction.",
                    url: "https://www.w3schools.com/html/mov_bbb.mp4"
                },
                {
                    title: "Geometry Fundamentals",
                    description: "Master fundamental concepts of geometry including shapes, angles, and measurements.",
                    url: "https://www.w3schools.com/html/movie.mp4"
                },
                {
                    title: "Advanced Calculus",
                    description: "Explore differential and integral calculus with practical examples and applications.",
                    url: "https://www.w3schools.com/html/mov_bbb.mp4"
                }
            ],
            science: [
                {
                    title: "Introduction to Physics",
                    description: "Discover the fundamental laws of physics that govern our universe.",
                    url: "https://www.w3schools.com/html/movie.mp4"
                },
                {
                    title: "Chemistry Basics",
                    description: "Learn about atoms, molecules, and chemical reactions in this beginner-friendly guide.",
                    url: "https://www.w3schools.com/html/mov_bbb.mp4"
                },
                {
                    title: "Biology Fundamentals",
                    description: "Explore the fascinating world of living organisms and life processes.",
                    url: "https://www.w3schools.com/html/movie.mp4"
                }
            ],
            sst: [
                {
                    title: "World History Overview",
                    description: "Journey through the major events that shaped our modern world.",
                    url: "https://www.w3schools.com/html/movie.mp4"
                },
                {
                    title: "Geography Essentials",
                    description: "Understand maps, continents, countries, and geographical features.",
                    url: "https://www.w3schools.com/html/movie.mp4"
                },
                {
                    title: "Civics and Government",
                    description: "Learn about different government systems and civic responsibilities.",
                    url: "https://www.w3schools.com/html/movie.mp4"
                }
            ],
            english: [
                {
                    title: "Grammar Fundamentals",
                    description: "Master the essential rules of English grammar and sentence structure.",
                    url: "https://www.w3schools.com/html/movie.mp4"
                },
                {
                    title: "Creative Writing",
                    description: "Develop your creative writing skills with practical tips and exercises.",
                    url: "https://www.w3schools.com/html/movie.mp4"
                },
                {
                    title: "Literature Analysis",
                    description: "Learn how to analyze and interpret literary works effectively.",
                    url: "https://www.w3schools.com/html/movie.mp4"
                }
            ]
        };

        // --- STUDENT LEARNING PORTAL DATA ---
        const worksheetData = {
            "6": [
                { name: "Maths Resources (PW)", url: "https://www.pw.live/class-6-maths", icon: "üìê" },
                { name: "Science Resources (PW)", url: "https://www.pw.live/class-6-science", icon: "üß™" },
                { name: "Social Science Worksheets", url: "https://onepointlearning.com/ncert-class-6-social-science-worksheets-with-answers/", icon: "üåç" },
                { name: "English Worksheets", url: "https://www.learncbse.in/class-6-english-worksheets/", icon: "üìñ" },
                { name: "Hindi Sample Papers (Vedantu)", url: "https://www.vedantu.com/sample-papers/cbse-sample-papers-for-class-6-hindi", icon: "‚úçÔ∏è" }
            ],
            "7": [
                { name: "Maths Worksheet (PW)", url: "https://www.pw.live/school-prep/exams/class-7-maths-worksheet", icon: "üìê" },
                { name: "Science Worksheets (PW)", url: "https://www.pw.live/school-prep/exams/class-7-science-worksheets", icon: "üß™" },
                { name: "Social Science (StudiesToday)", url: "https://www.studiestoday.com/worksheets/322/social-science.html", icon: "üó∫Ô∏è" },
                { name: "English Worksheets (LearnCBSE)", url: "https://www.learncbse.in/class-7-english-worksheets/", icon: "üìñ" },
                { name: "Hindi Sample Papers (Vedantu)", url: "https://www.vedantu.com/sample-papers/cbse-sample-papers-for-class-7-hindi", icon: "‚úçÔ∏è" }
            ],
            "8": [
                { name: "Maths Sample Papers (PW)", url: "https://www.pw.live/sample-papers-for-class-8-maths", icon: "üìê" },
                { name: "Science Sample Papers (PW)", url: "https://www.pw.live/sample-papers-class-8-science", icon: "üß™" },
                { name: "Social Science Mock Paper (Vedantu)", url: "https://www.vedantu.com/sample-papers/cbse-sample-papers-for-class-8-social-science-mock-paper-7", icon: "üåç" },
                { name: "English Sample Papers (PW)", url: "https://www.pw.live/school-prep/exams/cbse-class-8-english-sample-papers", icon: "üìñ" },
                { name: "Hindi Sample Papers (Vedantu)", url: "https://www.vedantu.com/sample-papers/cbse-sample-papers-for-class-8-hindi", icon: "‚úçÔ∏è" }
            ]
        };

        // --- PW LITTLE CHAMPS VIDEO DATA ---
        const pwVideos = {
            6: {
                'Science': { url: 'https://www.youtube.com/embed/Cih7YcEoA4U', title: 'Class 6th Complete Science Marathon | Toppers Toli üî•' },
                'SST': { url: 'https://www.youtube.com/embed/T-nSdKjqZnA', title: 'Class 6th Complete SST Marathon | Toppers Toli üî•' },
                'Maths': { url: 'https://www.youtube.com/embed/g2V-78fwWyg', title: 'Class 6th Complete Maths Marathon | Toppers Toli üî•' },
                'Hindi': { url: 'https://www.youtube.com/embed/E00uXJwnr0U', title: 'Class 6th Complete Hindi Marathon | Toppers Toli üî•' }
            },
            7: {
                'Hindi': { url: 'https://www.youtube.com/embed/Tc_vn5G_BKk', title: 'Class 7th Complete Hindi Marathon | Toppers Toli üî•' },
                'Social': { url: 'https://www.youtube.com/embed/DRrdXGhKwG0', title: 'Class 7th Complete Social Science Marathon | Toppers Toli üî•' },
                'Maths': { url: 'https://www.youtube.com/embed/fw2xy4L-dn0', title: 'Complete Maths, Mid Term Syllabus || Mid Term Marathonüî•|| Class 7th üìö' },
                'Science': { url: 'https://www.youtube.com/embed/6MXRADlrEHg', title: 'Class 7th Complete Science in 1 Video | Toppers Toli Marathonüî•' },
                'English': { url: 'https://www.youtube.com/embed/ll5MbtDtF90', title: 'Class 7th Complete English in 1 Video | Toppers Toli Marathonüî•' }
            },
            8: {
                'Hindi': { url: 'https://www.youtube.com/embed/7_M42dhOnNg', title: 'Class 8th Complete HINDI Marathon | Toppers Toli üî•‚ö°Ô∏è' },
                'Science': { url: 'https://www.youtube.com/embed/q1W5DSMohuA', title: 'Class 8th Complete SCIENCE Marathon | Toppers Toli üî•‚ö°Ô∏è' },
                'SST': { url: 'https://www.youtube.com/embed/T4JOtgvb0HY', title: 'Class 8th Complete SST Marathon | Toppers Toli üî•‚ö°Ô∏è' },
                'Maths': { url: 'https://www.youtube.com/embed/wOgn74jXk_Q', title: 'Class 8th Complete MATHS Marathon | Toppers Toli üî•‚ö°Ô∏è' }
            }
        };

        // --- POLYMATH ENGINE VARIABLES ---
        const WOLFRAMALPHA_APPID = 'YOUR_WOLFRAMALPHA_APPID'; // <-- PASTE YOUR APP ID HERE (REQUIRED FOR SCIENCE/ADV. MATH)
        const memoryStore = {};
        let lastUnknownQuestion = null;

        // --- CHILL GAMES VARIABLES ---
        let currentChillGame = '', isChillSoundOn = true, isChillPaused = false;
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        // XO Game Implementation
        let chillXoBoard = ['', '', '', '', '', '', '', '', ''];
        let chillXoPlayer = 'X';
        let chillXoGameActive = true;

        // Memory Game Implementation
        const chillMemoryCards = ['üçé', 'üçå', 'üçá', 'üçä', 'üçâ', 'üçì', 'üçí', 'ü•ù'];
        let chillMemoryGameCards = [];
        let chillFlippedCards = [];
        let chillMatchedPairs = 0;
        let chillMemoryMoves = 0;

        // Breakout Game Implementation
        let chillBreakoutBallX, chillBreakoutBallY, chillBreakoutBallDX, chillBreakoutBallDY, chillBreakoutBallRadius;
        let chillBreakoutPaddleHeight, chillBreakoutPaddleWidth, chillBreakoutPaddleX;
        let chillBreakoutBricks = [];
        const chillBreakoutBrickRowCount = 4;
        const chillBreakoutBrickColumnCount = 6;
        const chillBreakoutBrickWidth = 50;
        const chillBreakoutBrickHeight = 15;
        const chillBreakoutBrickPadding = 8;
        const chillBreakoutBrickOffsetTop = 20;
        const chillBreakoutBrickOffsetLeft = 20;
        let chillBreakoutScore = 0;
        let chillBreakoutInterval;
        let chillBreakoutRightPressed = false;
        let chillBreakoutLeftPressed = false;

        // Shooter Game Implementation
        let chillShooterPlayer, chillShooterBullets = [], chillShooterEnemies = [], chillShooterScore = 0;
        let chillShooterInterval;
        let chillShooterRightPressed = false;
        let chillShooterLeftPressed = false;
        let chillShooterSpacePressed = false;

        // Pong Game Implementation
        let chillPongBallX, chillPongBallY, chillPongBallDX, chillPongBallDY, chillPongBallRadius;
        let chillPongPaddleHeight, chillPongPaddleWidth, chillPongPlayerY, chillPongComputerY;
        let chillPongPlayerScore = 0;
        let chillPongComputerScore = 0;
        let chillPongInterval;
        let chillPongUpPressed = false;
        let chillPongDownPressed = false;

        // Dino Game Implementation
        let chillDino, chillDinoObstacles = [], chillDinoScore = 0;
        let chillDinoBestScore = parseInt(localStorage.getItem('chillDinoBestScore')) || 0;
        let chillDinoInterval;
        let chillDinoJump = false;
        let chillDinoGameSpeed = 4;
        let chillDinoClouds = [];
        let chillDinoFrameCount = 0;

        // Snake Game Implementation
        let snakeGame = null;

        // Tetris Game Implementation
        let tetrisGame = null;

        // Flappy Bird Game Implementation
        let flappyBirdGame = null;

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function login() {
            const name = document.getElementById('nameInput').value.trim();
            const cls = document.getElementById('classInput').value;
            const section = document.getElementById('sectionInput').value;
            const roll = document.getElementById('rollInput').value.trim();

            if (!name || !cls || !section || !roll) {
                alert('Please complete all fields to access Macro Vision Academy.');
                return;
            }

            currentStudent = { name, class: cls, section, roll };
            document.getElementById('studentInfo').innerHTML =
                `<strong>Welcome, ${name}!</strong><br>` +
                `Grade ${cls} ‚Ä¢ ${section} ‚Ä¢ ID: ${roll}`;

            showScreen('dashboardScreen');
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                currentStudent = {};
                document.getElementById('nameInput').value = '';
                document.getElementById('classInput').value = '';
                document.getElementById('sectionInput').value = '';
                document.getElementById('rollInput').value = '';
                showScreen('loginScreen');
            }
        }

        function showDashboard() { showScreen('dashboardScreen'); }
        function showSamplePapers() { showScreen('papersScreen'); }
        function showVideos() { showScreen('videosScreen'); }
        function showPolymath() { showScreen('polymathScreen'); }
        
        function showQuiz() { 
            showScreen('quizScreen');
            document.getElementById('quizSubjectSelection').style.display = 'grid';
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('quizResult').textContent = '';
            document.getElementById('quizSubHeading').textContent = 'Select a subject to start a 15-Question timed quiz ‚ú®';
        }
        
        function showGames() { 
            showScreen('gamesScreen');
            showChillGames(); // Show chill games grid by default
        }

        // STUDENT LEARNING PORTAL FUNCTIONS
        function handlePaperLogin() {
            const name = document.getElementById('firstName').value;
            const cls = document.getElementById('classSelect').value;
            const section = document.getElementById('section').value;
            const id = document.getElementById('studentID').value;

            if (!name || !cls || !section || !id) {
                alert("Please fill in all details.");
                return;
            }

            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('worksheetSection').style.display = 'block';

            document.getElementById('displayUserName').innerText = name;
            document.getElementById('displayInfo').innerText = `Class ${cls} - Sec ${section} (ID: ${id})`;

            const container = document.getElementById('linksContainer');
            container.innerHTML = ""; 

            const links = worksheetData[cls];

            if (links && links.length > 0) {
                links.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'resource-item';
                    div.innerHTML = `
                        <span class="subject-icon">${item.icon}</span>
                        <a href="${item.url}" target="_blank">${item.name}</a>
                        <span style="color: #94a3b8; font-size: 0.8rem;">Open ‚Üí</span>
                    `;
                    container.appendChild(div);
                });
            } else {
                container.innerHTML = `<p style="text-align:center; padding: 15px;">No links added for Class ${cls} yet.</p>`;
            }
        }

        function resetPaperLogin() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('worksheetSection').style.display = 'none';
            document.getElementById('firstName').value = '';
            document.getElementById('classSelect').value = '';
            document.getElementById('section').value = '';
            document.getElementById('studentID').value = '';
        }

        // PW LITTLE CHAMPS VIDEO SELECTOR FUNCTIONS
        // Tab Switching
        document.querySelectorAll('.class-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const classNum = tab.dataset.class;
                
                document.querySelectorAll('.class-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                document.querySelectorAll('.class-content').forEach(content => content.classList.remove('active'));
                document.getElementById(`class${classNum}`).classList.add('active');
                
                document.querySelectorAll('.video-container').forEach(container => {
                    container.classList.remove('show');
                });
            });
        });

        // Subject Selection Handlers
        [6, 7, 8].forEach(classNum => {
            const select = document.getElementById(`subject${classNum}`);
            const videoContainer = document.getElementById(`video${classNum}`);
            const videoFrame = document.getElementById(`videoFrame${classNum}`);
            const videoTitle = document.getElementById(`videoTitle${classNum}`);

            select.addEventListener('change', function() {
                const subject = this.value;
                if (subject && pwVideos[classNum] && pwVideos[classNum][subject]) {
                    const video = pwVideos[classNum][subject];
                    videoFrame.src = video.url;
                    videoTitle.textContent = video.title;
                    videoContainer.classList.add('show');
                } else {
                    videoContainer.classList.remove('show');
                    videoFrame.src = '';
                    videoTitle.textContent = '';
                }
            });
        });

        // --- POLYMATH ENGINE FUNCTIONS ---
        // MODULE 1: WOLFRAMALPHA API (Physics, Chemistry, Advanced Math)
        async function queryWolframAlpha(query) {
            if (WOLFRAMALPHA_APPID === 'YOUR_WOLFRAMALPHA_APPID') {
                return null; 
            }
            // Note: CORS proxy may be unstable or blocked in production environments.
            const proxyUrl = 'https://cors-anywhere.herokuapp.com/'; 
            const apiUrl = `http://api.wolframalpha.com/v2/result?i=${encodeURIComponent(query)}&appid=${WOLFRAMALPHA_APPID}`;
            
            try {
                const response = await fetch(proxyUrl + apiUrl);
                if (response.ok) {
                    const data = await response.text();
                    const trimmedData = data.trim();
                    return trimmedData.toLowerCase() !== "no result found" ? trimmedData : null;
                }
            } catch (error) {
                console.error("WolframAlpha API Error:", error);
            }
            return null;
        }

        // MODULE 2: WIKIPEDIA API (History, General Knowledge)
        async function searchWikipedia(query) {
            const url = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query)}`;
            try {
                const response = await fetch(url);
                if (!response.ok) return null;
                const data = await response.json();
                return data.extract || null;
            } catch (error) {
                return null;
            }
        }

        // MODULE 3: BUILT-IN MATH TUTOR (Fallback)
        function solveAdvancedMath(message) {
            const msg = message.toLowerCase().trim();
             if (msg.startsWith('solve') || msg.match(/[+\-*/^%]/)) {
                try {
                    const result = math.evaluate(message);
                    if (typeof result !== 'undefined' && result !== null) {
                        return `The calculated result is ${math.format(result, { precision: 14 })}.`;
                    }
                } catch (error) {
                     // Silent failure for non-evaluatable expressions
                }
            }
            return null;
        }
        
        // LEARNING MODULE
        function learn(question, answer) {
            memoryStore[question.toLowerCase()] = answer;
            return `Knowledge updated. MACRO VISION ACADEMY has stored fact that "${question}" is "${answer}".`;
        }

        // MAIN AI RESPONSE GENERATOR
        async function generateBotResponse(userMessage) {
            const msg = userMessage.toLowerCase().trim();

            // 1. Learning Logic
            if (lastUnknownQuestion && (msg.startsWith("the answer is") || msg.startsWith("it is") || msg.startsWith("it's"))) {
                const answer = userMessage.substring(userMessage.indexOf(' ') + 1).trim();
                const response = learn(lastUnknownQuestion, answer);
                lastUnknownQuestion = null;
                return response;
            }

            // 2. Memory Retrieval
            if (memoryStore[msg]) {
                return `(Retrieved from Academy Memory): ${memoryStore[msg]}`;
            }

            // 3. External APIs
            const wolframResult = await queryWolframAlpha(userMessage);
            if (wolframResult) {
                return `(WolframAlpha): ${wolframResult}`;
            }

            const wikiResult = await searchWikipedia(userMessage);
            if (wikiResult) {
                return `(Wikipedia): ${wikiResult}`;
            }
            
            // 4. Fallback Math
            const mathResult = solveAdvancedMath(userMessage);
            if (mathResult) {
                return mathResult;
            }

            // 5. Unknown/Learning Prompt
            lastUnknownQuestion = userMessage;
            return `Query not found in current data modules or memory. Please provide definitive answer to "${userMessage}" so I may learn it.`;
        }

        // POLYMATH UI FUNCTIONS
        function addPolymathMessage(content, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('polymath-message', sender);
            const avatarDiv = document.createElement('div'); avatarDiv.classList.add('polymath-avatar');
            // 'U' for User, '‚öõ' for Macro Bot
            avatarDiv.textContent = sender === 'user' ? 'U' : '‚öõ'; 
            const contentDiv = document.createElement('div'); contentDiv.classList.add('polymath-message-content');
            contentDiv.textContent = content;
            messageDiv.appendChild(avatarDiv); 
            messageDiv.appendChild(contentDiv);
            document.getElementById('polymath-chat-window').appendChild(messageDiv);
            document.getElementById('polymath-chat-window').scrollTop = document.getElementById('polymath-chat-window').scrollHeight;
        }

        function showPolymathTypingIndicator() {
            // Typing indicator uses '‚öõ' bot avatar
            const indicator = `<div class="polymath-message bot polymath-typing-indicator" id="polymath-typing-indicator"><div class="polymath-avatar">‚öõ</div><div class="polymath-message-content"><span></span><span></span><span></span></div></div>`;
            document.getElementById('polymath-chat-window').insertAdjacentHTML('beforeend', indicator);
            document.getElementById('polymath-chat-window').scrollTop = document.getElementById('polymath-chat-window').scrollHeight;
        }

        function hidePolymathTypingIndicator() {
            const indicator = document.getElementById('polymath-typing-indicator');
            if (indicator) { indicator.remove(); }
        }

        // POLYMATH EVENT LISTENER
        document.getElementById('polymath-chat-form').addEventListener('submit', async (event) => {
            event.preventDefault();
            const userMessage = document.getElementById('polymath-chat-input').value.trim();
            if (userMessage === '') return;

            addPolymathMessage(userMessage, 'user');
            document.getElementById('polymath-chat-input').value = '';
            showPolymathTypingIndicator();

            // Simulating API latency and processing time
            const typingDelay = 1000 + Math.random() * 1000;
            await new Promise(resolve => setTimeout(resolve, typingDelay));

            hidePolymathTypingIndicator();
            const botResponse = await generateBotResponse(userMessage);
            addPolymathMessage(botResponse, 'bot');
        });

        // QUIZ FUNCTIONS
        function startSubjectQuiz(subject) {
            currentQuiz.subject = subject;
            currentQuiz.questions = quizData[subject].slice(0, 15);
            currentQuiz.currentIndex = 0;
            currentQuiz.score = 0;
            currentQuiz.active = true;
            currentQuizAnswer = null; 

            document.getElementById('quizSubjectSelection').style.display = 'none';
            document.getElementById('quizContainer').style.display = 'block';
            document.getElementById('quizResult').textContent = '';
            document.getElementById('quizSubHeading').textContent = `Good luck with ${subject} Quiz!`;

            loadQuestion();
            startQuizTimer();
        }

        function loadQuestion() {
            if (currentQuiz.currentIndex >= currentQuiz.questions.length) {
                submitQuiz();
                return;
            }

            const qData = currentQuiz.questions[currentQuiz.currentIndex];
            const quizContent = document.getElementById('quizContent');
            const questionNumber = currentQuiz.currentIndex + 1;
            
            quizContent.innerHTML = `
                <div class="quiz-question">
                    <strong>Q${questionNumber}.</strong> ${qData.q}
                    <div class="quiz-options">
                        ${qData.options.map((opt, i) => 
                            `<div class="quiz-option" onclick="selectQuizAnswer(this, '${opt.replace(/'/g, "\\'")}')">${opt}</div>`
                        ).join('')}
                    </div>
                </div>
            `;
            currentQuizAnswer = null;
        }

        function nextQuestion() {
            if (!currentQuiz.active) {
                alert('Please select a subject quiz to start.');
                return;
            }

            if (!currentQuizAnswer) {
                alert('Please select an answer before proceeding to the next question.');
                return;
            }

            const qData = currentQuiz.questions[currentQuiz.currentIndex];
            if (currentQuizAnswer === qData.ans) {
                currentQuiz.score++;
            }

            currentQuiz.currentIndex++;

            if (currentQuiz.currentIndex < currentQuiz.questions.length) {
                loadQuestion();
            } else {
                submitQuiz();
            }
        }

        function submitQuiz() {
            if (!currentQuiz.active) {
                alert('No active quiz to submit. Please start a quiz first.');
                return;
            }
            
            if (currentQuiz.currentIndex === currentQuiz.questions.length - 1 && currentQuizAnswer) {
                const qData = currentQuiz.questions[currentQuiz.currentIndex];
                if (currentQuizAnswer === qData.ans) {
                    currentQuiz.score++;
                }
            } else if (currentQuiz.currentIndex < currentQuiz.questions.length) {
                 alert('Quiz submitted early!');
            }

            if (currentQuiz.timer) clearInterval(currentQuiz.timer);

            const percentage = ((currentQuiz.score / currentQuiz.questions.length) * 100).toFixed(0);

            document.getElementById('quizHeader').innerHTML = `‚úÖ Quiz Complete!`;
            document.getElementById('quizContent').innerHTML = `
                <div style="text-align:center; padding: 30px; color: #a8edea; font-size: 18px;">
                    You scored ${currentQuiz.score} out of ${currentQuiz.questions.length} questions.
                </div>
            `;
            document.getElementById('quizResult').innerHTML = `
                üéâ ${currentQuiz.subject} Mastery Level: ${percentage}% Score! ‚ú®
                <br>Keep practicing to reach 100%!
                <br><button class="btn back-btn" onclick="showQuiz()" style="margin-top: 15px; width: auto; display: inline-block; font-family: 'Poppins', sans-serif;">‚Ü© Start New Quiz</button>
            `;

            currentQuiz.active = false;
        }

        function startQuizTimer() {
            if (currentQuiz.timer) clearInterval(currentQuiz.timer);

            let time = 300;

            currentQuiz.timer = setInterval(() => {
                const minutes = Math.floor(time / 60);
                const seconds = time % 60;
                const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                document.getElementById('quizHeader').innerHTML = `‚è±Ô∏è ${currentQuiz.subject} Quiz | Q${currentQuiz.currentIndex + 1} of 15 | Time Left: ${timeString}`;

                if (time <= 0) {
                    clearInterval(currentQuiz.timer);
                    submitQuiz();
                    alert(`Time's up! Quiz Auto-Submitted.`);
                }
                time--;
            }, 1000);
        }

        function selectQuizAnswer(element, answer) {
            document.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            currentQuizAnswer = answer;
        }

        // CHILL GAMES FUNCTIONS - COMPACT VERSION
        function showChillGames() {
            // Stop all game loops
            if (chillBreakoutInterval) clearInterval(chillBreakoutInterval);
            if (chillShooterInterval) clearInterval(chillShooterInterval);
            if (chillPongInterval) clearInterval(chillPongInterval);
            if (chillDinoInterval) clearInterval(chillDinoInterval);
            if (snakeGame) clearInterval(snakeGame.gameLoop);
            if (tetrisGame) clearInterval(tetrisGame.gameLoop);
            if (flappyBirdGame) cancelAnimationFrame(flappyBirdGame.animationId);
            
            document.querySelectorAll('.chill-game-area').forEach(a => a.style.display = 'none');
            document.getElementById('chillGamesGrid').style.display = 'grid';
            document.getElementById('chillPauseOverlay').classList.remove('active');
            currentChillGame = '';
        }

        function showChillGame(game) {
            document.querySelectorAll('.chill-game-area').forEach(a => a.style.display = 'none');
            document.getElementById('chillGamesGrid').style.display = 'none';
            document.getElementById('chill' + game.charAt(0).toUpperCase() + game.slice(1) + 'Game').style.display = 'block';
            currentChillGame = game;
            
            // Initialize selected game
            switch(game) {
                case 'xo': initXO(); break;
                case 'snake': initSnake(); break;
                case 'tetris': initTetris(); break;
                case 'flappy': initFlappy(); break;
                case 'dino': initDino(); break;
                case 'memory': initMemory(); break;
                case 'breakout': initBreakout(); break;
                case 'shooter': initShooter(); break;
                case 'pong': initPong(); break;
            }
        }

        function toggleSound() { 
            isChillSoundOn = !isChillSoundOn; 
            document.getElementById('soundToggle').textContent = isChillSoundOn ? 'üîä' : 'üîá'; 
        }
        
        function togglePause() { 
            isChillPaused = !isChillPaused; 
            document.getElementById('chillPauseOverlay').classList.toggle('active'); 
        }

        function playChillSound(frequency, duration) {
            if (!isChillSoundOn) return;
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.frequency.value = frequency;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + duration);
        }

        // XO Game Implementation - COMPACT
        function initXO() {
            chillXoBoard = ['', '', '', '', '', '', '', '', ''];
            chillXoPlayer = 'X';
            chillXoGameActive = true;
            renderXOBoard();
        }

        function renderXOBoard() {
            const xoGrid = document.getElementById('chillXoGrid');
            xoGrid.innerHTML = '';
            
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('div');
                cell.className = 'chill-xo-cell';
                cell.textContent = chillXoBoard[i];
                cell.onclick = () => handleXOCellClick(i);
                xoGrid.appendChild(cell);
            }
        }

        function handleXOCellClick(index) {
            if (chillXoBoard[index] !== '' || !chillXoGameActive) return;
            
            chillXoBoard[index] = chillXoPlayer;
            renderXOBoard();
            
            if (checkXOWinner()) {
                document.getElementById('chillXoGrid').innerHTML += `<div style="position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;font-size:1.8em;">Player ${chillXoPlayer} wins!</div>`;
                chillXoGameActive = false;
                playChillSound(800, 0.5);
                return;
            }
            
            if (!chillXoBoard.includes('')) {
                document.getElementById('chillXoGrid').innerHTML += `<div style="position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;font-size:1.8em;">Draw!</div>`;
                chillXoGameActive = false;
                return;
            }
            
            chillXoPlayer = chillXoPlayer === 'X' ? 'O' : 'X';
        }

        function checkXOWinner() {
            const winPatterns = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], // rows
                [0, 3, 6], [1, 4, 7], [2, 5, 8], // columns
                [0, 4, 8], [2, 4, 6] // diagonals
            ];
            
            return winPatterns.some(pattern => {
                return pattern.every(index => chillXoBoard[index] === chillXoPlayer);
            });
        }

        function resetXO() {
            initXO();
        }

        // Snake Game Implementation - COMPACT
        function initSnake() {
            const canvas = document.getElementById('snake-canvas');
            const ctx = canvas.getContext('2d');
            
            snakeGame = {
                canvas: canvas,
                ctx: ctx,
                gridSize: 15,
                tileCount: canvas.width / 15,
                snake: [{x: 10, y: 10}],
                direction: {x: 0, y: 0},
                food: null,
                score: 0,
                gameRunning: false,
                gamePaused: false,
                gameLoop: null
            };
            
            // Generate initial food
            snakeGame.food = generateFood();
            
            // Update score display
            document.getElementById('snake-score').textContent = snakeGame.score;
            
            // Set up keyboard controls
            document.addEventListener('keydown', handleSnakeKeyPress);
            
            // Initial draw
            drawSnake();
        }

        function handleSnakeKeyPress(e) {
            if (!snakeGame || !snakeGame.gameRunning || snakeGame.gamePaused) return;

            switch(e.key) {
                case 'ArrowUp':
                    if (snakeGame.direction.y === 0) {
                        snakeGame.direction = {x: 0, y: -1};
                    }
                    break;
                case 'ArrowDown':
                    if (snakeGame.direction.y === 0) {
                        snakeGame.direction = {x: 0, y: 1};
                    }
                    break;
                case 'ArrowLeft':
                    if (snakeGame.direction.x === 0) {
                        snakeGame.direction = {x: -1, y: 0};
                    }
                    break;
                case 'ArrowRight':
                    if (snakeGame.direction.x === 0) {
                        snakeGame.direction = {x: 1, y: 0};
                    }
                    break;
            }
        }

        function generateFood() {
            return {
                x: Math.floor(Math.random() * snakeGame.tileCount),
                y: Math.floor(Math.random() * snakeGame.tileCount)
            };
        }

        function startSnake() {
            if (!snakeGame) {
                initSnake();
            }
            
            snakeGame.snake = [{x: 10, y: 10}];
            snakeGame.direction = {x: 1, y: 0};
            snakeGame.food = generateFood();
            snakeGame.score = 0;
            snakeGame.gameRunning = true;
            snakeGame.gamePaused = false;
            
            document.getElementById('snake-score').textContent = snakeGame.score;
            
            // Clear any existing game loop
            if (snakeGame.gameLoop) clearInterval(snakeGame.gameLoop);
            
            // Start game loop
            snakeGame.gameLoop = setInterval(updateSnake, 100);
        }

        function pauseSnake() {
            if (!snakeGame || !snakeGame.gameRunning) return;
            
            snakeGame.gamePaused = !snakeGame.gamePaused;
            
            if (snakeGame.gamePaused) {
                clearInterval(snakeGame.gameLoop);
            } else {
                snakeGame.gameLoop = setInterval(updateSnake, 100);
            }
        }

        function updateSnake() {
            if (!snakeGame.gameRunning || snakeGame.gamePaused) return;

            // Move snake head
            const head = {
                x: snakeGame.snake[0].x + snakeGame.direction.x,
                y: snakeGame.snake[0].y + snakeGame.direction.y
            };

            // Check wall collision
            if (head.x < 0 || head.x >= snakeGame.tileCount || 
                head.y < 0 || head.y >= snakeGame.tileCount) {
                gameOverSnake();
                return;
            }

            // Check self collision
            if (snakeGame.snake.some(segment => segment.x === head.x && segment.y === head.y)) {
                gameOverSnake();
                return;
            }

            snakeGame.snake.unshift(head);

            // Check food collision
            if (head.x === snakeGame.food.x && head.y === snakeGame.food.y) {
                snakeGame.score++;
                document.getElementById('snake-score').textContent = snakeGame.score;
                snakeGame.food = generateFood();
                playChillSound(400, 0.1);
            } else {
                snakeGame.snake.pop();
            }

            drawSnake();
        }

        function drawSnake() {
            // Clear canvas
            snakeGame.ctx.fillStyle = '#000000';
            snakeGame.ctx.fillRect(0, 0, snakeGame.canvas.width, snakeGame.canvas.height);

            // Draw snake
            snakeGame.ctx.fillStyle = '#FF7A00';
            snakeGame.snake.forEach(segment => {
                snakeGame.ctx.fillRect(
                    segment.x * snakeGame.gridSize,
                    segment.y * snakeGame.gridSize,
                    snakeGame.gridSize - 2,
                    snakeGame.gridSize - 2
                );
            });

            // Draw food
            snakeGame.ctx.fillStyle = '#FFFFFF';
            snakeGame.ctx.fillRect(
                snakeGame.food.x * snakeGame.gridSize,
                snakeGame.food.y * snakeGame.gridSize,
                snakeGame.gridSize - 2,
                snakeGame.gridSize - 2
            );

            if (!snakeGame.gameRunning) {
                snakeGame.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                snakeGame.ctx.fillRect(0, 0, snakeGame.canvas.width, snakeGame.canvas.height);
                snakeGame.ctx.fillStyle = '#FF7A00';
                snakeGame.ctx.font = 'bold 20px Arial';
                snakeGame.ctx.textAlign = 'center';
                snakeGame.ctx.fillText('Press Start to Play', snakeGame.canvas.width / 2, snakeGame.canvas.height / 2);
            }
        }

        function gameOverSnake() {
            snakeGame.gameRunning = false;
            clearInterval(snakeGame.gameLoop);
            
            snakeGame.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            snakeGame.ctx.fillRect(0, 0, snakeGame.canvas.width, snakeGame.canvas.height);
            snakeGame.ctx.fillStyle = '#FF7A00';
            snakeGame.ctx.font = 'bold 20px Arial';
            snakeGame.ctx.textAlign = 'center';
            snakeGame.ctx.fillText(`Game Over! Score: ${snakeGame.score}`, snakeGame.canvas.width / 2, snakeGame.canvas.height / 2);
        }

        // Tetris Game Implementation - COMPACT
        function initTetris() {
            const canvas = document.getElementById('tetris-canvas');
            const ctx = canvas.getContext('2d');
            
            tetrisGame = {
                canvas: canvas,
                ctx: ctx,
                blockSize: 20,
                cols: 10,
                rows: 18,
                board: Array(18).fill().map(() => Array(10).fill(0)),
                score: 0,
                gameRunning: false,
                gamePaused: false,
                currentPiece: null,
                dropCounter: 0,
                lastTime: 0,
                gameLoop: null
            };
            
            // Update score display
            document.getElementById('tetris-score').textContent = tetrisGame.score;
            
            // Set up keyboard controls
            document.addEventListener('keydown', handleTetrisKeyPress);
            
            // Initial draw
            drawTetris();
        }

        function handleTetrisKeyPress(e) {
            if (!tetrisGame || !tetrisGame.gameRunning || tetrisGame.gamePaused) return;

            switch(e.key) {
                case 'ArrowLeft':
                    moveTetrisPiece(-1, 0);
                    break;
                case 'ArrowRight':
                    moveTetrisPiece(1, 0);
                    break;
                case 'ArrowDown':
                    moveTetrisPiece(0, 1);
                    break;
                case 'ArrowUp':
                    rotateTetrisPiece();
                    break;
            }
        }

        function startTetris() {
            if (!tetrisGame) {
                initTetris();
            }
            
            tetrisGame.board = Array(18).fill().map(() => Array(10).fill(0));
            tetrisGame.score = 0;
            tetrisGame.gameRunning = true;
            tetrisGame.gamePaused = false;
            tetrisGame.currentPiece = createTetrisPiece();
            
            document.getElementById('tetris-score').textContent = tetrisGame.score;
            
            // Clear any existing game loop
            if (tetrisGame.gameLoop) cancelAnimationFrame(tetrisGame.gameLoop);
            
            // Start game loop
            tetrisGame.lastTime = 0;
            tetrisGame.dropCounter = 0;
            tetrisGame.gameLoop = requestAnimationFrame(updateTetris);
        }

        function pauseTetris() {
            if (!tetrisGame || !tetrisGame.gameRunning) return;
            
            tetrisGame.gamePaused = !tetrisGame.gamePaused;
            
            if (tetrisGame.gamePaused) {
                cancelAnimationFrame(tetrisGame.gameLoop);
            } else {
                tetrisGame.gameLoop = requestAnimationFrame(updateTetris);
            }
        }

        function createTetrisPiece() {
            const pieces = [
                [[1,1,1,1]], // I
                [[1,1],[1,1]], // O
                [[0,1,0],[1,1,1]], // T
                [[1,1,0],[0,1,1]], // S
                [[0,1,1],[1,1,0]], // Z
                [[1,0,0],[1,1,1]], // L
                [[0,0,1],[1,1,1]]  // J
            ];
            const piece = pieces[Math.floor(Math.random() * pieces.length)];
            return {
                shape: piece,
                x: Math.floor(10 / 2) - Math.floor(piece[0].length / 2),
                y: 0,
                color: `hsl(${Math.random() * 360}, 70%, 50%)`
            };
        }

        function moveTetrisPiece(dx, dy) {
            if (!tetrisGame.currentPiece) return;
            
            tetrisGame.currentPiece.x += dx;
            tetrisGame.currentPiece.y += dy;

            if (tetrisCollision()) {
                tetrisGame.currentPiece.x -= dx;
                tetrisGame.currentPiece.y -= dy;

                if (dy > 0) {
                    lockTetrisPiece();
                    clearTetrisLines();
                    tetrisGame.currentPiece = createTetrisPiece();
                    
                    if (tetrisCollision()) {
                        gameOverTetris();
                    }
                }
            }
        }

        function rotateTetrisPiece() {
            if (!tetrisGame.currentPiece) return;
            
            const rotated = tetrisGame.currentPiece.shape[0].map((_, i) =>
                tetrisGame.currentPiece.shape.map(row => row[i]).reverse()
            );
            
            const previousShape = tetrisGame.currentPiece.shape;
            tetrisGame.currentPiece.shape = rotated;

            if (tetrisCollision()) {
                tetrisGame.currentPiece.shape = previousShape;
            }
        }

        function tetrisCollision() {
            if (!tetrisGame.currentPiece) return false;
            
            for (let y = 0; y < tetrisGame.currentPiece.shape.length; y++) {
                for (let x = 0; x < tetrisGame.currentPiece.shape[y].length; x++) {
                    if (tetrisGame.currentPiece.shape[y][x]) {
                        const boardX = tetrisGame.currentPiece.x + x;
                        const boardY = tetrisGame.currentPiece.y + y;

                        if (boardX < 0 || boardX >= tetrisGame.cols || 
                            boardY >= tetrisGame.rows ||
                            (boardY >= 0 && tetrisGame.board[boardY][boardX])) {
                            return true;
                        }
                    }
                }
            }
            return false;
        }

        function lockTetrisPiece() {
            for (let y = 0; y < tetrisGame.currentPiece.shape.length; y++) {
                for (let x = 0; x < tetrisGame.currentPiece.shape[y].length; x++) {
                    if (tetrisGame.currentPiece.shape[y][x]) {
                        const boardY = tetrisGame.currentPiece.y + y;
                        const boardX = tetrisGame.currentPiece.x + x;
                        if (boardY >= 0) {
                            tetrisGame.board[boardY][boardX] = tetrisGame.currentPiece.color;
                        }
                    }
                }
            }
        }

        function clearTetrisLines() {
            let linesCleared = 0;
            
            for (let y = tetrisGame.rows - 1; y >= 0; y--) {
                if (tetrisGame.board[y].every(cell => cell !== 0)) {
                    tetrisGame.board.splice(y, 1);
                    tetrisGame.board.unshift(Array(tetrisGame.cols).fill(0));
                    linesCleared++;
                    y++;
                }
            }

            if (linesCleared > 0) {
                tetrisGame.score += linesCleared * 100;
                document.getElementById('tetris-score').textContent = tetrisGame.score;
                playChillSound(600, 0.2);
            }
        }

        function drawTetris() {
            tetrisGame.ctx.fillStyle = '#000000';
            tetrisGame.ctx.fillRect(0, 0, tetrisGame.canvas.width, tetrisGame.canvas.height);

            // Draw board
            for (let y = 0; y < tetrisGame.rows; y++) {
                for (let x = 0; x < tetrisGame.cols; x++) {
                    if (tetrisGame.board[y][x]) {
                        tetrisGame.ctx.fillStyle = tetrisGame.board[y][x];
                        tetrisGame.ctx.fillRect(
                            x * tetrisGame.blockSize,
                            y * tetrisGame.blockSize,
                            tetrisGame.blockSize - 1,
                            tetrisGame.blockSize - 1
                        );
                    }
                }
            }

            // Draw current piece
            if (tetrisGame.currentPiece) {
                tetrisGame.ctx.fillStyle = tetrisGame.currentPiece.color;
                for (let y = 0; y < tetrisGame.currentPiece.shape.length; y++) {
                    for (let x = 0; x < tetrisGame.currentPiece.shape[y].length; x++) {
                        if (tetrisGame.currentPiece.shape[y][x]) {
                            tetrisGame.ctx.fillRect(
                                (tetrisGame.currentPiece.x + x) * tetrisGame.blockSize,
                                (tetrisGame.currentPiece.y + y) * tetrisGame.blockSize,
                                tetrisGame.blockSize - 1,
                                tetrisGame.blockSize - 1
                            );
                        }
                    }
                }
            }

            if (!tetrisGame.gameRunning) {
                tetrisGame.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                tetrisGame.ctx.fillRect(0, 0, tetrisGame.canvas.width, tetrisGame.canvas.height);
                tetrisGame.ctx.fillStyle = '#FF7A00';
                tetrisGame.ctx.font = 'bold 16px Arial';
                tetrisGame.ctx.textAlign = 'center';
                tetrisGame.ctx.fillText('Press Start to Play', tetrisGame.canvas.width / 2, tetrisGame.canvas.height / 2);
            }
        }

        function updateTetris(time = 0) {
            if (!tetrisGame.gameRunning || tetrisGame.gamePaused) return;

            const deltaTime = time - tetrisGame.lastTime;
            tetrisGame.lastTime = time;
            tetrisGame.dropCounter += deltaTime;

            if (tetrisGame.dropCounter > 800) {
                moveTetrisPiece(0, 1);
                tetrisGame.dropCounter = 0;
            }

            drawTetris();
            tetrisGame.gameLoop = requestAnimationFrame((time) => updateTetris(time));
        }

        function gameOverTetris() {
            tetrisGame.gameRunning = false;
            cancelAnimationFrame(tetrisGame.gameLoop);
            
            tetrisGame.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            tetrisGame.ctx.fillRect(0, 0, tetrisGame.canvas.width, tetrisGame.canvas.height);
            tetrisGame.ctx.fillStyle = '#FF7A00';
            tetrisGame.ctx.font = 'bold 16px Arial';
            tetrisGame.ctx.textAlign = 'center';
            tetrisGame.ctx.fillText(`Game Over! Score: ${tetrisGame.score}`, tetrisGame.canvas.width / 2, tetrisGame.canvas.height / 2);
        }

        // Flappy Bird Game Implementation - COMPACT
        function initFlappy() {
            const canvas = document.getElementById('flappy-canvas');
            const ctx = canvas.getContext('2d');
            
            flappyBirdGame = {
                canvas: canvas,
                ctx: ctx,
                bird: {
                    x: 50,
                    y: canvas.height / 2,
                    velocity: 0,
                    radius: 12
                },
                pipes: [],
                score: 0,
                gameRunning: false,
                gravity: 0.5,
                jumpStrength: -8,
                pipeWidth: 40,
                pipeGap: 100,
                pipeSpeed: 2,
                animationId: null
            };
            
            // Update score display
            document.getElementById('flappy-score').textContent = flappyBirdGame.score;
            
            // Set up controls
            canvas.addEventListener('click', () => jumpFlappy());
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space') {
                    e.preventDefault();
                    jumpFlappy();
                }
            });
            
            // Initial draw
            drawFlappy();
        }

        function jumpFlappy() {
            if (!flappyBirdGame || !flappyBirdGame.gameRunning) return;
            flappyBirdGame.bird.velocity = flappyBirdGame.jumpStrength;
        }

        function startFlappy() {
            if (!flappyBirdGame) {
                initFlappy();
            }
            
            flappyBirdGame.bird = {
                x: 50,
                y: flappyBirdGame.canvas.height / 2,
                velocity: 0,
                radius: 12
            };
            flappyBirdGame.pipes = [];
            flappyBirdGame.score = 0;
            flappyBirdGame.gameRunning = true;
            
            document.getElementById('flappy-score').textContent = flappyBirdGame.score;
            
            // Clear any existing animation
            if (flappyBirdGame.animationId) cancelAnimationFrame(flappyBirdGame.animationId);
            
            // Start game loop
            flappyBirdGame.animationId = requestAnimationFrame(updateFlappy);
        }

        function updateFlappy() {
            if (!flappyBirdGame.gameRunning) return;

            // Update bird
            flappyBirdGame.bird.velocity += flappyBirdGame.gravity;
            flappyBirdGame.bird.y += flappyBirdGame.bird.velocity;

            // Check boundaries
            if (flappyBirdGame.bird.y - flappyBirdGame.bird.radius < 0 || 
                flappyBirdGame.bird.y + flappyBirdGame.bird.radius > flappyBirdGame.canvas.height) {
                gameOverFlappy();
                return;
            }

            // Update pipes
            for (let i = flappyBirdGame.pipes.length - 1; i >= 0; i--) {
                flappyBirdGame.pipes[i].x -= flappyBirdGame.pipeSpeed;

                // Remove off-screen pipes
                if (flappyBirdGame.pipes[i].x + flappyBirdGame.pipeWidth < 0) {
                    flappyBirdGame.pipes.splice(i, 1);
                    continue;
                }

                // Check collision
                if (checkFlappyCollision(flappyBirdGame.pipes[i])) {
                    gameOverFlappy();
                    return;
                }

                // Score point
                if (flappyBirdGame.pipes[i].x + flappyBirdGame.pipeWidth < flappyBirdGame.bird.x && !flappyBirdGame.pipes[i].scored) {
                    flappyBirdGame.score++;
                    document.getElementById('flappy-score').textContent = flappyBirdGame.score;
                    flappyBirdGame.pipes[i].scored = true;
                    playChillSound(600, 0.1);
                }
            }

            // Add new pipes
            if (flappyBirdGame.pipes.length === 0 || flappyBirdGame.pipes[flappyBirdGame.pipes.length - 1].x < flappyBirdGame.canvas.width - 200) {
                const gapY = Math.random() * (flappyBirdGame.canvas.height - flappyBirdGame.pipeGap - 50) + 50;
                flappyBirdGame.pipes.push({
                    x: flappyBirdGame.canvas.width,
                    gapY: gapY,
                    scored: false
                });
            }

            drawFlappy();
            flappyBirdGame.animationId = requestAnimationFrame(updateFlappy);
        }

        function checkFlappyCollision(pipe) {
            // Check collision with top pipe
            if (flappyBirdGame.bird.x + flappyBirdGame.bird.radius > pipe.x && 
                flappyBirdGame.bird.x - flappyBirdGame.bird.radius < pipe.x + flappyBirdGame.pipeWidth) {
                if (flappyBirdGame.bird.y - flappyBirdGame.bird.radius < pipe.gapY || 
                    flappyBirdGame.bird.y + flappyBirdGame.bird.radius > pipe.gapY + flappyBirdGame.pipeGap) {
                    return true;
                }
            }
            return false;
        }

        function drawFlappy() {
            // Clear canvas
            flappyBirdGame.ctx.fillStyle = '#000000';
            flappyBirdGame.ctx.fillRect(0, 0, flappyBirdGame.canvas.width, flappyBirdGame.canvas.height);

            // Draw bird
            flappyBirdGame.ctx.fillStyle = '#FF7A00';
            flappyBirdGame.ctx.beginPath();
            flappyBirdGame.ctx.arc(flappyBirdGame.bird.x, flappyBirdGame.bird.y, flappyBirdGame.bird.radius, 0, Math.PI * 2);
            flappyBirdGame.ctx.fill();

            // Draw pipes
            flappyBirdGame.ctx.fillStyle = '#FFFFFF';
            flappyBirdGame.pipes.forEach(pipe => {
                // Top pipe
                flappyBirdGame.ctx.fillRect(pipe.x, 0, flappyBirdGame.pipeWidth, pipe.gapY);
                // Bottom pipe
                flappyBirdGame.ctx.fillRect(pipe.x, pipe.gapY + flappyBirdGame.pipeGap, flappyBirdGame.pipeWidth, 
                                         flappyBirdGame.canvas.height - pipe.gapY - flappyBirdGame.pipeGap);
            });

            if (!flappyBirdGame.gameRunning) {
                flappyBirdGame.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                flappyBirdGame.ctx.fillRect(0, 0, flappyBirdGame.canvas.width, flappyBirdGame.canvas.height);
                flappyBirdGame.ctx.fillStyle = '#FF7A00';
                flappyBirdGame.ctx.font = 'bold 20px Arial';
                flappyBirdGame.ctx.textAlign = 'center';
                flappyBirdGame.ctx.fillText('Press Start to Play', flappyBirdGame.canvas.width / 2, flappyBirdGame.canvas.height / 2);
            }
        }

        function gameOverFlappy() {
            flappyBirdGame.gameRunning = false;
            cancelAnimationFrame(flappyBirdGame.animationId);
            
            flappyBirdGame.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            flappyBirdGame.ctx.fillRect(0, 0, flappyBirdGame.canvas.width, flappyBirdGame.canvas.height);
            flappyBirdGame.ctx.fillStyle = '#FF7A00';
            flappyBirdGame.ctx.font = 'bold 20px Arial';
            flappyBirdGame.ctx.textAlign = 'center';
            flappyBirdGame.ctx.fillText(`Game Over! Score: ${flappyBirdGame.score}`, flappyBirdGame.canvas.width / 2, flappyBirdGame.canvas.height / 2);
        }

        // Dino Game Implementation - COMPACT
        function initDino() {
            const canvas = document.getElementById('dino-canvas');
            const ctx = canvas.getContext('2d');
            
            chillDino = {
                canvas: canvas,
                ctx: ctx,
                dino: {
                    x: 50,
                    y: canvas.height - 60,
                    width: 30,
                    height: 40,
                    velocity: 0,
                    jumping: false
                },
                obstacles: [],
                score: 0,
                bestScore: parseInt(localStorage.getItem('chillDinoBestScore')) || 0,
                gameRunning: false,
                gravity: 0.6,
                jumpStrength: -10,
                obstacleSpeed: 4,
                groundY: canvas.height - 30,
                gameSpeed: 4,
                clouds: [],
                frameCount: 0,
                gameLoop: null
            };
            
            // Update score display
            document.getElementById('dino-score').textContent = chillDino.score;
            document.getElementById('dino-best-score').textContent = chillDino.bestScore;
            
            // Set up controls
            canvas.addEventListener('click', () => jumpDino());
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space') {
                    e.preventDefault();
                    jumpDino();
                }
            });
            
            // Initial draw
            drawDino();
        }

        function jumpDino() {
            if (!chillDino || !chillDino.gameRunning) return;
            if (!chillDino.dino.jumping) {
                chillDino.dino.velocity = chillDino.jumpStrength;
                chillDino.dino.jumping = true;
                playChillSound(400, 0.1);
            }
        }

        function startDino() {
            if (!chillDino) {
                initDino();
            }
            
            chillDino.dino = {
                x: 50,
                y: chillDino.canvas.height - 60,
                width: 30,
                height: 40,
                velocity: 0,
                jumping: false
            };
            chillDino.obstacles = [];
            chillDino.score = 0;
            chillDino.gameRunning = true;
            chillDino.gameSpeed = 4;
            
            document.getElementById('dino-score').textContent = chillDino.score;
            
            // Create initial obstacle
            chillDino.obstacles.push({
                x: chillDino.canvas.width,
                y: chillDino.groundY - 40,
                width: 15,
                height: 30,
                type: 'cactus'
            });
            
            // Clear any existing game loop
            if (chillDino.gameLoop) clearInterval(chillDino.gameLoop);
            
            // Start game loop
            chillDino.gameLoop = setInterval(updateDino, 1000 / 60); // 60 FPS
        }

        function updateDino() {
            if (!chillDino.gameRunning) return;
            
            chillDino.frameCount++;
            
            // Update dino
            chillDino.dino.velocity += chillDino.gravity;
            chillDino.dino.y += chillDino.dino.velocity;
            
            // Ground collision
            if (chillDino.dino.y > chillDino.groundY - chillDino.dino.height) {
                chillDino.dino.y = chillDino.groundY - chillDino.dino.height;
                chillDino.dino.velocity = 0;
                chillDino.dino.jumping = false;
            }
            
            // Update obstacles
            for (let i = chillDino.obstacles.length - 1; i >= 0; i--) {
                chillDino.obstacles[i].x -= chillDino.gameSpeed;
                
                // Remove obstacles that go off screen
                if (chillDino.obstacles[i].x + chillDino.obstacles[i].width < 0) {
                    chillDino.obstacles.splice(i, 1);
                    i--;
                    
                    // Add new obstacle
                    const obstacleType = Math.random();
                    
                    if (obstacleType < 0.7) {
                        // Regular cactus
                        chillDino.obstacles.push({
                            x: chillDino.canvas.width,
                            y: chillDino.groundY - 40,
                            width: 15,
                            height: 30,
                            type: 'cactus'
                        });
                    } else if (obstacleType < 0.9) {
                        // Flying obstacle
                        chillDino.obstacles.push({
                            x: chillDino.canvas.width,
                            y: chillDino.groundY - 60,
                            width: 25,
                            height: 20,
                            type: 'bird'
                        });
                    } else {
                        // Double cactus
                        chillDino.obstacles.push({
                            x: chillDino.canvas.width,
                            y: chillDino.groundY - 40,
                            width: 30,
                            height: 30,
                            type: 'doubleCactus'
                        });
                    }
                    
                    // Increase score
                    chillDino.score++;
                    document.getElementById('dino-score').textContent = chillDino.score;
                    
                    // Increase speed every 10 points
                    if (chillDino.score % 10 === 0) {
                        chillDino.gameSpeed += 0.5;
                    }
                    continue;
                }
                
                // Check for collision with obstacles
                if (
                    chillDino.dino.x < chillDino.obstacles[i].x + chillDino.obstacles[i].width &&
                    chillDino.dino.x + chillDino.dino.width > chillDino.obstacles[i].x &&
                    chillDino.dino.y < chillDino.obstacles[i].y + chillDino.obstacles[i].height &&
                    chillDino.dino.y + chillDino.dino.height > chillDino.obstacles[i].y
                ) {
                    gameOverDino();
                    return;
                }
            }
            
            drawDino();
        }

        function drawDino() {
            // Clear canvas
            chillDino.ctx.fillStyle = '#fff';
            chillDino.ctx.fillRect(0, 0, chillDino.canvas.width, chillDino.canvas.height);
            
            // Draw ground
            chillDino.ctx.strokeStyle = '#333';
            chillDino.ctx.lineWidth = 2;
            chillDino.ctx.beginPath();
            chillDino.ctx.moveTo(0, chillDino.groundY);
            chillDino.ctx.lineTo(chillDino.canvas.width, chillDino.groundY);
            chillDino.ctx.stroke();
            
            // Draw dino
            chillDino.ctx.fillStyle = '#333';
            chillDino.ctx.fillRect(chillDino.dino.x, chillDino.dino.y, chillDino.dino.width, chillDino.dino.height);
            
            // Draw obstacles
            chillDino.ctx.fillStyle = '#333';
            chillDino.obstacles.forEach(obstacle => {
                chillDino.ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
            });
            
            if (!chillDino.gameRunning) {
                chillDino.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                chillDino.ctx.fillRect(0, 0, chillDino.canvas.width, chillDino.canvas.height);
                chillDino.ctx.fillStyle = '#fff';
                chillDino.ctx.font = '20px Arial';
                chillDino.ctx.textAlign = 'center';
                chillDino.ctx.fillText('Press Start to Play', chillDino.canvas.width / 2, chillDino.canvas.height / 2);
            }
        }

        function gameOverDino() {
            chillDino.gameRunning = false;
            clearInterval(chillDino.gameLoop);
            
            // Update best score
            if (chillDino.score > chillDino.bestScore) {
                chillDino.bestScore = chillDino.score;
                localStorage.setItem('chillDinoBestScore', chillDino.bestScore);
                document.getElementById('dino-best-score').textContent = chillDino.bestScore;
            }
            
            chillDino.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            chillDino.ctx.fillRect(0, 0, chillDino.canvas.width, chillDino.canvas.height);
            chillDino.ctx.fillStyle = '#fff';
            chillDino.ctx.font = '20px Arial';
            chillDino.ctx.textAlign = 'center';
            chillDino.ctx.fillText(`Game Over! Score: ${chillDino.score}`, chillDino.canvas.width / 2, chillDino.canvas.height / 2);
        }

        // Memory Game Implementation - COMPACT
        function initMemory() {
            chillMemoryGameCards = [...chillMemoryCards, ...chillMemoryCards];
            chillMemoryGameCards.sort(() => Math.random() - 0.5);
            chillFlippedCards = [];
            chillMatchedPairs = 0;
            chillMemoryMoves = 0;
            document.getElementById('chillMemoryMoves').textContent = chillMemoryMoves;
            renderMemoryGrid();
        }

        function renderMemoryGrid() {
            const memoryGrid = document.getElementById('chillMemoryGrid');
            memoryGrid.innerHTML = '';
            
            chillMemoryGameCards.forEach((emoji, index) => {
                const card = document.createElement('div');
                card.className = 'chill-memory-card';
                card.dataset.index = index;
                card.dataset.emoji = emoji;
                
                const cardBack = document.createElement('div');
                cardBack.className = 'chill-card-face chill-card-back';
                cardBack.textContent = '?';
                
                const cardFront = document.createElement('div');
                cardFront.className = 'chill-card-face chill-card-front';
                cardFront.textContent = emoji;
                
                card.appendChild(cardBack);
                card.appendChild(cardFront);
                
                card.addEventListener('click', flipMemoryCard);
                memoryGrid.appendChild(card);
            });
        }

        function flipMemoryCard() {
            if (chillFlippedCards.length >= 2) return;
            if (this.classList.contains('flipped')) return;
            if (this.classList.contains('matched')) return;
            
            this.classList.add('flipped');
            chillFlippedCards.push(this);
            
            if (chillFlippedCards.length === 2) {
                chillMemoryMoves++;
                document.getElementById('chillMemoryMoves').textContent = chillMemoryMoves;
                
                if (chillFlippedCards[0].dataset.emoji === chillFlippedCards[1].dataset.emoji) {
                    // Match found
                    chillFlippedCards[0].classList.add('matched');
                    chillFlippedCards[1].classList.add('matched');
                    chillFlippedCards = [];
                    chillMatchedPairs++;
                    playChillSound(600, 0.2);
                    
                    if (chillMatchedPairs === chillMemoryCards.length / 2) {
                        setTimeout(() => {
                            document.getElementById('chillMemoryGrid').innerHTML += `<div style="position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;font-size:1.5em;">You won in ${chillMemoryMoves} moves!</div>`;
                            playChillSound(800, 0.5);
                        }, 500);
                    }
                } else {
                    // No match
                    setTimeout(() => {
                        chillFlippedCards.forEach(card => card.classList.remove('flipped'));
                        chillFlippedCards = [];
                    }, 800);
                }
            }
        }

        function resetMemory() {
            initMemory();
        }

        // Breakout Game Implementation - COMPACT
        function initBreakout() {
            const canvas = document.getElementById('chillBreakoutCanvas');
            const ctx = canvas.getContext('2d');
            
            chillBreakoutScore = 0;
            document.getElementById('chillBreakoutScore').textContent = chillBreakoutScore;
            
            // Initialize bricks
            chillBreakoutBricks = [];
            for (let c = 0; c < chillBreakoutBrickColumnCount; c++) {
                chillBreakoutBricks[c] = [];
                for (let r = 0; r < chillBreakoutBrickRowCount; r++) {
                    chillBreakoutBricks[c][r] = { x: 0, y: 0, status: 1 };
                }
            }
            
            // Reset ball and paddle
            chillBreakoutBallX = 400 / 2;
            chillBreakoutBallY = 300 - 20;
            chillBreakoutBallDX = 3;
            chillBreakoutBallDY = -3;
            chillBreakoutBallRadius = 8;
            chillBreakoutPaddleHeight = 8;
            chillBreakoutPaddleWidth = 70;
            chillBreakoutPaddleX = (400 - chillBreakoutPaddleWidth) / 2;
            
            // Clear any existing interval
            if (chillBreakoutInterval) clearInterval(chillBreakoutInterval);
            
            // Start game loop
            chillBreakoutInterval = setInterval(drawBreakout, 10);
            
            // Add keyboard controls
            document.addEventListener('keydown', keyDownBreakout);
            document.addEventListener('keyup', keyUpBreakout);
        }

        function keyDownBreakout(e) {
            if (currentChillGame !== 'breakout') return;
            
            if (e.key === 'Right' || e.key === 'ArrowRight' || e.key === 'd') {
                chillBreakoutRightPressed = true;
            } else if (e.key === 'Left' || e.key === 'ArrowLeft' || e.key === 'a') {
                chillBreakoutLeftPressed = true;
            }
        }

        function keyUpBreakout(e) {
            if (currentChillGame !== 'breakout') return;
            
            if (e.key === 'Right' || e.key === 'ArrowRight' || e.key === 'd') {
                chillBreakoutRightPressed = false;
            } else if (e.key === 'Left' || e.key === 'ArrowLeft' || e.key === 'a') {
                chillBreakoutLeftPressed = false;
            }
        }

        function collisionDetectionBreakout() {
            for (let c = 0; c < chillBreakoutBrickColumnCount; c++) {
                for (let r = 0; r < chillBreakoutBrickRowCount; r++) {
                    const b = chillBreakoutBricks[c][r];
                    if (b.status === 1) {
                        if (chillBreakoutBallX > b.x && chillBreakoutBallX < b.x + chillBreakoutBrickWidth &&
                            chillBreakoutBallY > b.y && chillBreakoutBallY < b.y + chillBreakoutBrickHeight) {
                            chillBreakoutBallDY = -chillBreakoutBallDY;
                            b.status = 0;
                            chillBreakoutScore += 10;
                            document.getElementById('chillBreakoutScore').textContent = chillBreakoutScore;
                            playChillSound(400, 0.1);
                            
                            // Check if all bricks are destroyed
                            if (chillBreakoutScore === chillBreakoutBrickRowCount * chillBreakoutBrickColumnCount * 10) {
                                gameOverBreakout(true);
                            }
                        }
                    }
                }
            }
        }

        function drawBreakout() {
            if (isChillPaused) return;
            
            const canvas = document.getElementById('chillBreakoutCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw bricks
            for (let c = 0; c < chillBreakoutBrickColumnCount; c++) {
                for (let r = 0; r < chillBreakoutBrickRowCount; r++) {
                    if (chillBreakoutBricks[c][r].status === 1) {
                        const brickX = c * (chillBreakoutBrickWidth + chillBreakoutBrickPadding) + chillBreakoutBrickOffsetLeft;
                        const brickY = r * (chillBreakoutBrickHeight + chillBreakoutBrickPadding) + chillBreakoutBrickOffsetTop;
                        chillBreakoutBricks[c][r].x = brickX;
                        chillBreakoutBricks[c][r].y = brickY;
                        
                        // Different colors for different rows
                        const colors = ['#FF5252', '#FF9800', '#FFEB3B', '#4CAF50', '#2196F3'];
                        ctx.fillStyle = colors[r];
                        ctx.fillRect(brickX, brickY, chillBreakoutBrickWidth, chillBreakoutBrickHeight);
                    }
                }
            }
            
            // Draw ball
            ctx.beginPath();
            ctx.arc(chillBreakoutBallX, chillBreakoutBallY, chillBreakoutBallRadius, 0, Math.PI * 2);
            ctx.fillStyle = '#0095DD';
            ctx.fill();
            ctx.closePath();
            
            // Draw paddle
            ctx.fillStyle = '#0095DD';
            ctx.fillRect(chillBreakoutPaddleX, canvas.height - chillBreakoutPaddleHeight, chillBreakoutPaddleWidth, chillBreakoutPaddleHeight);
            
            // Ball collision with walls
            if (chillBreakoutBallX + chillBreakoutBallDX > canvas.width - chillBreakoutBallRadius || chillBreakoutBallX + chillBreakoutBallDX < chillBreakoutBallRadius) {
                chillBreakoutBallDX = -chillBreakoutBallDX;
            }
            
            // Ball collision with ceiling
            if (chillBreakoutBallY + chillBreakoutBallDY < chillBreakoutBallRadius) {
                chillBreakoutBallDY = -chillBreakoutBallDY;
            } else if (chillBreakoutBallY + chillBreakoutBallDY > canvas.height - chillBreakoutBallRadius) {
                // Ball collision with paddle
                if (chillBreakoutBallX > chillBreakoutPaddleX && chillBreakoutBallX < chillBreakoutPaddleX + chillBreakoutPaddleWidth) {
                    chillBreakoutBallDY = -chillBreakoutBallDY;
                    playChillSound(300, 0.1);
                } else {
                    // Game over
                    gameOverBreakout(false);
                    return;
                }
            }
            
            // Move paddle
            if (chillBreakoutRightPressed && chillBreakoutPaddleX < canvas.width - chillBreakoutPaddleWidth) {
                chillBreakoutPaddleX += 6;
            } else if (chillBreakoutLeftPressed && chillBreakoutPaddleX > 0) {
                chillBreakoutPaddleX -= 6;
            }
            
            // Move ball
            chillBreakoutBallX += chillBreakoutBallDX;
            chillBreakoutBallY += chillBreakoutBallDY;
            
            // Check for brick collisions
            collisionDetectionBreakout();
        }

        function gameOverBreakout(won) {
            clearInterval(chillBreakoutInterval);
            
            const canvas = document.getElementById('chillBreakoutCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '#fff';
            ctx.font = '20px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(won ? 'YOU WIN!' : 'GAME OVER', canvas.width / 2, canvas.height / 2);
            ctx.fillText(`Score: ${chillBreakoutScore}`, canvas.width / 2, canvas.height / 2 + 30);
            
            playChillSound(won ? 800 : 200, 0.5);
        }

        function resetBreakout() {
            initBreakout();
        }

        // Shooter Game Implementation - COMPACT
        function initShooter() {
            const canvas = document.getElementById('chillShooterCanvas');
            const ctx = canvas.getContext('2d');
            
            chillShooterScore = 0;
            document.getElementById('chillShooterScore').textContent = chillShooterScore;
            
            // Reset player position
            chillShooterPlayer = {
                x: 400 / 2,
                y: 300 - 40,
                width: 40,
                height: 40,
                speed: 5
            };
            
            // Clear bullets and enemies
            chillShooterBullets = [];
            chillShooterEnemies = [];
            
            // Create initial enemies
            for (let i = 0; i < 4; i++) {
                chillShooterEnemies.push({
                    x: Math.random() * (400 - 25),
                    y: Math.random() * 80,
                    width: 25,
                    height: 25,
                    speed: 1 + Math.random() * 1.5
                });
            }
            
            // Clear any existing interval
            if (chillShooterInterval) clearInterval(chillShooterInterval);
            
            // Start game loop
            chillShooterInterval = setInterval(drawShooter, 1000 / 60); // 60 FPS
            
            // Add keyboard controls
            document.addEventListener('keydown', keyDownShooter);
            document.addEventListener('keyup', keyUpShooter);
        }

        function keyDownShooter(e) {
            if (currentChillGame !== 'shooter') return;
            
            if (e.key === 'Right' || e.key === 'ArrowRight' || e.key === 'd') {
                chillShooterRightPressed = true;
            } else if (e.key === 'Left' || e.key === 'ArrowLeft' || e.key === 'a') {
                chillShooterLeftPressed = true;
            } else if (e.key === ' ' || e.key === 'Space') {
                chillShooterSpacePressed = true;
            }
        }

        function keyUpShooter(e) {
            if (currentChillGame !== 'shooter') return;
            
            if (e.key === 'Right' || e.key === 'ArrowRight' || e.key === 'd') {
                chillShooterRightPressed = false;
            } else if (e.key === 'Left' || e.key === 'ArrowLeft' || e.key === 'a') {
                chillShooterLeftPressed = false;
            } else if (e.key === ' ' || e.key === 'Space') {
                chillShooterSpacePressed = false;
            }
        }

        function drawShooter() {
            if (isChillPaused) return;
            
            const canvas = document.getElementById('chillShooterCanvas');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw stars background
            for (let i = 0; i < 30; i++) {
                ctx.fillStyle = '#fff';
                ctx.fillRect(
                    Math.random() * canvas.width,
                    Math.random() * canvas.height,
                    1, 1
                );
            }
            
            // Move player
            if (chillShooterRightPressed && chillShooterPlayer.x < canvas.width - chillShooterPlayer.width) {
                chillShooterPlayer.x += chillShooterPlayer.speed;
            } else if (chillShooterLeftPressed && chillShooterPlayer.x > 0) {
                chillShooterPlayer.x -= chillShooterPlayer.speed;
            }
            
            // Shoot bullets
            if (chillShooterSpacePressed) {
                if (!chillShooterBullets.length || chillShooterBullets[chillShooterBullets.length - 1].y < chillShooterPlayer.y - 20) {
                    chillShooterBullets.push({
                        x: chillShooterPlayer.x + chillShooterPlayer.width / 2 - 2.5,
                        y: chillShooterPlayer.y,
                        width: 5,
                        height: 8,
                        speed: 7
                    });
                    playChillSound(800, 0.1);
                }
            }
            
            // Update bullets
            for (let i = 0; i < chillShooterBullets.length; i++) {
                chillShooterBullets[i].y -= chillShooterBullets[i].speed;
                
                // Remove bullets that go off screen
                if (chillShooterBullets[i].y < 0) {
                    chillShooterBullets.splice(i, 1);
                    i--;
                }
            }
            
            // Update enemies
            for (let i = 0; i < chillShooterEnemies.length; i++) {
                chillShooterEnemies[i].y += chillShooterEnemies[i].speed;
                
                // Check if enemy reached bottom
                if (chillShooterEnemies[i].y > canvas.height) {
                    chillShooterEnemies.splice(i, 1);
                    i--;
                    
                    // Add new enemy at top
                    chillShooterEnemies.push({
                        x: Math.random() * (canvas.width - 25),
                        y: -25,
                        width: 25,
                        height: 25,
                        speed: 1 + Math.random() * 1.5
                    });
                }
            }
            
            // Check for collisions between bullets and enemies
            for (let i = 0; i < chillShooterBullets.length; i++) {
                for (let j = 0; j < chillShooterEnemies.length; j++) {
                    if (
                        chillShooterBullets[i].x < chillShooterEnemies[j].x + chillShooterEnemies[j].width &&
                        chillShooterBullets[i].x + chillShooterBullets[i].width > chillShooterEnemies[j].x &&
                        chillShooterBullets[i].y < chillShooterEnemies[j].y + chillShooterEnemies[j].height &&
                        chillShooterBullets[i].y + chillShooterBullets[i].height > chillShooterEnemies[j].y
                    ) {
                        // Remove bullet and enemy
                        chillShooterBullets.splice(i, 1);
                        chillShooterEnemies.splice(j, 1);
                        i--;
                        j--;
                        
                        // Increase score
                        chillShooterScore += 10;
                        document.getElementById('chillShooterScore').textContent = chillShooterScore;
                        playChillSound(400, 0.1);
                        
                        // Add new enemy at top
                        chillShooterEnemies.push({
                            x: Math.random() * (canvas.width - 25),
                            y: -25,
                            width: 25,
                            height: 25,
                            speed: 1 + Math.random() * 1.5
                        });
                        
                        break;
                    }
                }
            }
            
            // Draw player
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(chillShooterPlayer.x, chillShooterPlayer.y, chillShooterPlayer.width, chillShooterPlayer.height);
            
            // Draw bullets
            ctx.fillStyle = '#FFEB3B';
            for (const bullet of chillShooterBullets) {
                ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
            }
            
            // Draw enemies
            ctx.fillStyle = '#F44336';
            for (const enemy of chillShooterEnemies) {
                ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
            }
        }

        function resetShooter() {
            initShooter();
        }

        // Pong Game Implementation - COMPACT
        function initPong() {
            const canvas = document.getElementById('chillPongCanvas');
            const ctx = canvas.getContext('2d');
            
            chillPongPlayerScore = 0;
            chillPongComputerScore = 0;
            document.getElementById('chillPongPlayerScore').textContent = chillPongPlayerScore;
            document.getElementById('chillPongCompScore').textContent = chillPongComputerScore;
            
            // Reset ball position
            chillPongBallX = 400 / 2;
            chillPongBallY = 250 / 2;
            chillPongBallDX = 4;
            chillPongBallDY = 4;
            chillPongBallRadius = 8;
            
            // Reset paddle positions
            chillPongPaddleHeight = 60;
            chillPongPaddleWidth = 10;
            chillPongPlayerY = (250 - chillPongPaddleHeight) / 2;
            chillPongComputerY = (250 - chillPongPaddleHeight) / 2;
            
            // Clear any existing interval
            if (chillPongInterval) clearInterval(chillPongInterval);
            
            // Start game loop
            chillPongInterval = setInterval(drawPong, 1000 / 60); // 60 FPS
            
            // Add keyboard controls
            document.addEventListener('keydown', keyDownPong);
            document.addEventListener('keyup', keyUpPong);
        }

        function keyDownPong(e) {
            if (currentChillGame !== 'pong') return;
            
            if (e.key === 'Up' || e.key === 'ArrowUp' || e.key === 'w') {
                chillPongUpPressed = true;
            } else if (e.key === 'Down' || e.key === 'ArrowDown' || e.key === 's') {
                chillPongDownPressed = true;
            }
        }

        function keyUpPong(e) {
            if (currentChillGame !== 'pong') return;
            
            if (e.key === 'Up' || e.key === 'ArrowUp' || e.key === 'w') {
                chillPongUpPressed = false;
            } else if (e.key === 'Down' || e.key === 'ArrowDown' || e.key === 's') {
                chillPongDownPressed = false;
            }
        }

        function drawPong() {
            if (isChillPaused) return;
            
            const canvas = document.getElementById('chillPongCanvas');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw middle line
            ctx.setLineDash([5, 10]);
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, 0);
            ctx.lineTo(canvas.width / 2, canvas.height);
            ctx.strokeStyle = '#FFF';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Move player paddle
            if (chillPongUpPressed && chillPongPlayerY > 0) {
                chillPongPlayerY -= 6;
            } else if (chillPongDownPressed && chillPongPlayerY < canvas.height - chillPongPaddleHeight) {
                chillPongPlayerY += 6;
            }
            
            // Simple AI for computer paddle
            const computerSpeed = 4;
            const paddleCenter = chillPongComputerY + chillPongPaddleHeight / 2;
            
            if (paddleCenter < chillPongBallY - 25) {
                chillPongComputerY += computerSpeed;
            } else if (paddleCenter > chillPongBallY + 25) {
                chillPongComputerY -= computerSpeed;
            }
            
            // Move ball
            chillPongBallX += chillPongBallDX;
            chillPongBallY += chillPongBallDY;
            
            // Ball collision with top and bottom walls
            if (chillPongBallY + chillPongBallDY > canvas.height || chillPongBallY + chillPongBallDY < 0) {
                chillPongBallDY = -chillPongBallDY;
                playChillSound(300, 0.1);
            }
            
            // Ball collision with player paddle
            if (
                chillPongBallX - chillPongBallRadius < chillPongPaddleWidth &&
                chillPongBallY > chillPongPlayerY &&
                chillPongBallY < chillPongPlayerY + chillPongPaddleHeight
            ) {
                chillPongBallDX = -chillPongBallDX;
                
                // Add some spin based on where ball hits paddle
                const collidePoint = chillPongBallY - (chillPongPlayerY + chillPongPaddleHeight / 2);
                chillPongBallDY = collidePoint * 0.1;
                
                playChillSound(300, 0.1);
            }
            
            // Ball collision with computer paddle
            if (
                chillPongBallX + chillPongBallRadius > canvas.width - chillPongPaddleWidth &&
                chillPongBallY > chillPongComputerY &&
                chillPongBallY < chillPongComputerY + chillPongPaddleHeight
            ) {
                chillPongBallDX = -chillPongBallDX;
                
                // Add some spin based on where ball hits paddle
                const collidePoint = chillPongBallY - (chillPongComputerY + chillPongPaddleHeight / 2);
                chillPongBallDY = collidePoint * 0.1;
                
                playChillSound(300, 0.1);
            }
            
            // Score if ball goes off screen
            if (chillPongBallX - chillPongBallRadius < 0) {
                chillPongComputerScore++;
                document.getElementById('chillPongCompScore').textContent = chillPongComputerScore;
                resetBall();
                playChillSound(200, 0.3);
            } else if (chillPongBallX + chillPongBallRadius > canvas.width) {
                chillPongPlayerScore++;
                document.getElementById('chillPongPlayerScore').textContent = chillPongPlayerScore;
                resetBall();
                playChillSound(600, 0.3);
            }
            
            // Draw ball
            ctx.beginPath();
            ctx.arc(chillPongBallX, chillPongBallY, chillPongBallRadius, 0, Math.PI * 2);
            ctx.fillStyle = '#FFF';
            ctx.fill();
            ctx.closePath();
            
            // Draw player paddle
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(0, chillPongPlayerY, chillPongPaddleWidth, chillPongPaddleHeight);
            
            // Draw computer paddle
            ctx.fillStyle = '#F44336';
            ctx.fillRect(canvas.width - chillPongPaddleWidth, chillPongComputerY, chillPongPaddleWidth, chillPongPaddleHeight);
        }

        function resetBall() {
            chillPongBallX = 400 / 2;
            chillPongBallY = 250 / 2;
            chillPongBallDX = -chillPongBallDX;
            chillPongBallDY = 4;
        }

        function resetPong() {
            initPong();
        }
    </script>
</body>
</html>